"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("middleware",{

/***/ "(middleware)/./middleware.ts":
/*!***********************!*\
  !*** ./middleware.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   middleware: () => (/* binding */ middleware)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(middleware)/./node_modules/next/dist/esm/api/server.js\");\n/* harmony import */ var better_auth_cookies__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! better-auth/cookies */ \"(middleware)/./node_modules/better-auth/dist/cookies/index.mjs\");\n\n\n/**\n * IMPORTANT:\n * - We no longer check membership or activeOrganizationId here.\n * - We ONLY verify that the user has a valid session if they attempt\n *   to access private routes.\n */ async function middleware(request) {\n    const { pathname } = request.nextUrl;\n    console.log(\"Middleware: requested pathname\", pathname);\n    // 1) Allow static assets and files (e.g., CSS, JS, images)\n    if (pathname.startsWith(\"/_next\") || pathname.startsWith(\"/static\") || pathname.includes(\".\")) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n    }\n    // 2) Define public routes\n    const publicRoutes = [\n        \"/\",\n        \"/login\",\n        \"/signup\",\n        \"/forgot-password\",\n        \"/reset-password\",\n        \"/about-us\",\n        \"/api/auth\",\n        \"/api/auth/reset-password\",\n        \"/admin/login\",\n        \"/accept\",\n        \"/set-password\",\n        \"/accept-invitation\",\n        \"/accept-invite\",\n        \"/api/check-user\",\n        \"/api/create-user\",\n        \"/invite\",\n        \"/api/invite\",\n        \"/check-email\"\n    ];\n    // 3) Define allowed routes (public + onboarding + settings)\n    const allowedRoutes = [\n        ...publicRoutes,\n        \"/onboarding/organization\",\n        \"/onboarding/bot-keys\",\n        \"/onboarding/support-email\",\n        \"/onboarding/secret-phrase\",\n        \"/settings\",\n        \"/select-organization\",\n        \"/dashboard\" // We allow direct access to select-organization page\n    ];\n    const isAllowed = allowedRoutes.some((route)=>pathname === route || pathname.startsWith(route + \"/\"));\n    console.log(`Middleware: Is ${pathname} allowed? ${isAllowed}`);\n    // If it's allowed, we don't force a session check\n    if (isAllowed) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n    }\n    // 4) For internal API endpoints, check the x-internal-token header\n    if (pathname.startsWith(\"/api/internal\")) {\n        const token = request.headers.get(\"x-internal-token\");\n        if (token !== \"Zx1pa3f6OEI02rxQFMaMDOpVM7VVtSkaa\") {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Unauthorized\"\n            }, {\n                status: 403\n            });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n    }\n    // 5) If accessing an admin route (other than /admin/login), verify full session and role\n    if (pathname.startsWith(\"/admin\") && pathname !== \"/admin/login\") {\n        const sessionRes = await fetch(new URL(\"/api/auth/get-session\", request.url), {\n            headers: {\n                cookie: request.headers.get(\"cookie\") || \"\"\n            }\n        });\n        if (!sessionRes.ok) {\n            console.log(`Middleware: Redirecting to /admin/login from ${pathname}`);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(\"/admin/login\", request.url));\n        }\n        const sessionData = await sessionRes.json();\n        if (!sessionData || !sessionData.user || sessionData.user.role !== \"admin\" && sessionData.user.role !== \"superAdmin\") {\n            console.log(`Middleware: Unauthorized admin access to ${pathname}`);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(\"/admin/login\", request.url));\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n    }\n    // 6) For all other routes not covered above, we check for a session cookie\n    const sessionCookie = (0,better_auth_cookies__WEBPACK_IMPORTED_MODULE_1__.getSessionCookie)(request);\n    if (!sessionCookie) {\n        console.log(`Middleware: No session cookie, redirecting to /login from ${pathname}`);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(\"/login\", request.url));\n    }\n    // 7) Validate that session object is correct\n    const sessionRes = await fetch(new URL(\"/api/auth/get-session\", request.url), {\n        headers: {\n            cookie: request.headers.get(\"cookie\") || \"\"\n        }\n    });\n    if (!sessionRes.ok) {\n        console.log(`Middleware: Invalid session, redirecting to /login from ${pathname}`);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(\"/login\", request.url));\n    }\n    // If the session is valid, we do NOT check the activeOrganizationId or membership here\n    // because that requires DB calls => not supported in Edge runtime.\n    // We'll let layout.tsx handle membership & org checks.\n    // 8) Everything else is allowed\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n}\nconst config = {\n    matcher: \"/:path*\"\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFDLElBQUlKLElBQUksVUFBVXhCLFFBQVF5QixHQUFHO0lBQzVEO0lBRUEsNkNBQTZDO0lBQzdDLE1BQU1ILGFBQWEsTUFBTUMsTUFBTSxJQUFJQyxJQUFJLHlCQUF5QnhCLFFBQVF5QixHQUFHLEdBQUc7UUFDNUVYLFNBQVM7WUFDUFksUUFBUTFCLFFBQVFjLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLGFBQWE7UUFDM0M7SUFDRjtJQUNBLElBQUksQ0FBQ08sV0FBV0ssRUFBRSxFQUFFO1FBQ2xCeEIsUUFBUUMsR0FBRyxDQUFDLENBQUMsd0RBQXdELEVBQUVILFNBQVMsQ0FBQztRQUNqRixPQUFPSixxREFBWUEsQ0FBQytCLFFBQVEsQ0FBQyxJQUFJSixJQUFJLFVBQVV4QixRQUFReUIsR0FBRztJQUM1RDtJQUVBLHVGQUF1RjtJQUN2RixtRUFBbUU7SUFDbkUsdURBQXVEO0lBRXZELGdDQUFnQztJQUNoQyxPQUFPNUIscURBQVlBLENBQUNVLElBQUk7QUFDMUI7QUFFTyxNQUFNMEIsU0FBUztJQUNwQkMsU0FBUztBQUNYLEVBQUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vbWlkZGxld2FyZS50cz80MjJkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tIFwibmV4dC9zZXJ2ZXJcIjtcbmltcG9ydCB7IGdldFNlc3Npb25Db29raWUgfSBmcm9tIFwiYmV0dGVyLWF1dGgvY29va2llc1wiO1xuXG4vKipcbiAqIElNUE9SVEFOVDpcbiAqIC0gV2Ugbm8gbG9uZ2VyIGNoZWNrIG1lbWJlcnNoaXAgb3IgYWN0aXZlT3JnYW5pemF0aW9uSWQgaGVyZS5cbiAqIC0gV2UgT05MWSB2ZXJpZnkgdGhhdCB0aGUgdXNlciBoYXMgYSB2YWxpZCBzZXNzaW9uIGlmIHRoZXkgYXR0ZW1wdFxuICogICB0byBhY2Nlc3MgcHJpdmF0ZSByb3V0ZXMuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBtaWRkbGV3YXJlKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIGNvbnN0IHsgcGF0aG5hbWUgfSA9IHJlcXVlc3QubmV4dFVybDtcblxuICBjb25zb2xlLmxvZyhcIk1pZGRsZXdhcmU6IHJlcXVlc3RlZCBwYXRobmFtZVwiLCBwYXRobmFtZSk7XG5cbiAgLy8gMSkgQWxsb3cgc3RhdGljIGFzc2V0cyBhbmQgZmlsZXMgKGUuZy4sIENTUywgSlMsIGltYWdlcylcbiAgaWYgKFxuICAgIHBhdGhuYW1lLnN0YXJ0c1dpdGgoXCIvX25leHRcIikgfHxcbiAgICBwYXRobmFtZS5zdGFydHNXaXRoKFwiL3N0YXRpY1wiKSB8fFxuICAgIHBhdGhuYW1lLmluY2x1ZGVzKFwiLlwiKVxuICApIHtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLm5leHQoKTtcbiAgfVxuXG4gIC8vIDIpIERlZmluZSBwdWJsaWMgcm91dGVzXG4gIGNvbnN0IHB1YmxpY1JvdXRlcyA9IFtcbiAgICBcIi9cIixcbiAgICBcIi9sb2dpblwiLFxuICAgIFwiL3NpZ251cFwiLFxuICAgIFwiL2ZvcmdvdC1wYXNzd29yZFwiLFxuICAgIFwiL3Jlc2V0LXBhc3N3b3JkXCIsXG4gICAgXCIvYWJvdXQtdXNcIixcbiAgICBcIi9hcGkvYXV0aFwiLFxuICAgIFwiL2FwaS9hdXRoL3Jlc2V0LXBhc3N3b3JkXCIsXG4gICAgXCIvYWRtaW4vbG9naW5cIixcbiAgICBcIi9hY2NlcHRcIiwgICAgICAgICAgICAgLy8gRm9yIC9hY2NlcHQvW2ludml0YXRpb25JZF1cbiAgICBcIi9zZXQtcGFzc3dvcmRcIiwgICAgICAgLy8gRm9yIG5ldyB1c2VycyB0byBzZXQgdGhlaXIgcGFzc3dvcmRcbiAgICBcIi9hY2NlcHQtaW52aXRhdGlvblwiLCAgLy8gQ292ZXJzIC9hY2NlcHQtaW52aXRhdGlvbi9baW52aXRhdGlvbklkXVxuICAgIFwiL2FjY2VwdC1pbnZpdGVcIiwgICAgICAvLyBDb25maXJtYXRpb24gcGFnZVxuICAgIFwiL2FwaS9jaGVjay11c2VyXCIsICAgICAvLyBBUEkgdG8gY2hlY2sgaWYgdXNlciBleGlzdHNcbiAgICBcIi9hcGkvY3JlYXRlLXVzZXJcIiwgICAgLy8gQVBJIHRvIGNyZWF0ZSB1c2Vyc1xuICAgIFwiL2ludml0ZVwiLCAgICAgICAgICAgICAvLyBDb3ZlcnMgL2ludml0ZS9baW52aXRhdGlvbklkXVxuICAgIFwiL2FwaS9pbnZpdGVcIixcbiAgICBcIi9jaGVjay1lbWFpbFwiLCAgICAgICAgLy8gQWxsb3cgQVBJIGNhbGxzIGZvciBpbnZpdGF0aW9uc1xuICBdO1xuXG4gIC8vIDMpIERlZmluZSBhbGxvd2VkIHJvdXRlcyAocHVibGljICsgb25ib2FyZGluZyArIHNldHRpbmdzKVxuICBjb25zdCBhbGxvd2VkUm91dGVzID0gW1xuICAgIC4uLnB1YmxpY1JvdXRlcyxcbiAgICBcIi9vbmJvYXJkaW5nL29yZ2FuaXphdGlvblwiLFxuICAgIFwiL29uYm9hcmRpbmcvYm90LWtleXNcIixcbiAgICBcIi9vbmJvYXJkaW5nL3N1cHBvcnQtZW1haWxcIixcbiAgICBcIi9vbmJvYXJkaW5nL3NlY3JldC1waHJhc2VcIixcbiAgICBcIi9zZXR0aW5nc1wiLFxuICAgIFwiL3NlbGVjdC1vcmdhbml6YXRpb25cIixcbiAgICBcIi9kYXNoYm9hcmRcIiAvLyBXZSBhbGxvdyBkaXJlY3QgYWNjZXNzIHRvIHNlbGVjdC1vcmdhbml6YXRpb24gcGFnZVxuICBdO1xuXG4gIGNvbnN0IGlzQWxsb3dlZCA9IGFsbG93ZWRSb3V0ZXMuc29tZShcbiAgICAocm91dGUpID0+IHBhdGhuYW1lID09PSByb3V0ZSB8fCBwYXRobmFtZS5zdGFydHNXaXRoKHJvdXRlICsgXCIvXCIpXG4gICk7XG5cbiAgY29uc29sZS5sb2coYE1pZGRsZXdhcmU6IElzICR7cGF0aG5hbWV9IGFsbG93ZWQ/ICR7aXNBbGxvd2VkfWApO1xuICAvLyBJZiBpdCdzIGFsbG93ZWQsIHdlIGRvbid0IGZvcmNlIGEgc2Vzc2lvbiBjaGVja1xuICBpZiAoaXNBbGxvd2VkKSB7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5uZXh0KCk7XG4gIH1cblxuICAvLyA0KSBGb3IgaW50ZXJuYWwgQVBJIGVuZHBvaW50cywgY2hlY2sgdGhlIHgtaW50ZXJuYWwtdG9rZW4gaGVhZGVyXG4gIGlmIChwYXRobmFtZS5zdGFydHNXaXRoKFwiL2FwaS9pbnRlcm5hbFwiKSkge1xuICAgIGNvbnN0IHRva2VuID0gcmVxdWVzdC5oZWFkZXJzLmdldChcIngtaW50ZXJuYWwtdG9rZW5cIik7XG4gICAgaWYgKHRva2VuICE9PSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19JTlRFUk5BTF9UT0tFTikge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IFwiVW5hdXRob3JpemVkXCIgfSwgeyBzdGF0dXM6IDQwMyB9KTtcbiAgICB9XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5uZXh0KCk7XG4gIH1cblxuICAvLyA1KSBJZiBhY2Nlc3NpbmcgYW4gYWRtaW4gcm91dGUgKG90aGVyIHRoYW4gL2FkbWluL2xvZ2luKSwgdmVyaWZ5IGZ1bGwgc2Vzc2lvbiBhbmQgcm9sZVxuICBpZiAocGF0aG5hbWUuc3RhcnRzV2l0aChcIi9hZG1pblwiKSAmJiBwYXRobmFtZSAhPT0gXCIvYWRtaW4vbG9naW5cIikge1xuICAgIGNvbnN0IHNlc3Npb25SZXMgPSBhd2FpdCBmZXRjaChuZXcgVVJMKFwiL2FwaS9hdXRoL2dldC1zZXNzaW9uXCIsIHJlcXVlc3QudXJsKSwge1xuICAgICAgaGVhZGVyczoge1xuICAgICAgICBjb29raWU6IHJlcXVlc3QuaGVhZGVycy5nZXQoXCJjb29raWVcIikgfHwgXCJcIixcbiAgICAgIH0sXG4gICAgfSk7XG4gICAgaWYgKCFzZXNzaW9uUmVzLm9rKSB7XG4gICAgICBjb25zb2xlLmxvZyhgTWlkZGxld2FyZTogUmVkaXJlY3RpbmcgdG8gL2FkbWluL2xvZ2luIGZyb20gJHtwYXRobmFtZX1gKTtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QobmV3IFVSTChcIi9hZG1pbi9sb2dpblwiLCByZXF1ZXN0LnVybCkpO1xuICAgIH1cbiAgICBjb25zdCBzZXNzaW9uRGF0YSA9IGF3YWl0IHNlc3Npb25SZXMuanNvbigpO1xuICAgIGlmIChcbiAgICAgICFzZXNzaW9uRGF0YSB8fFxuICAgICAgIXNlc3Npb25EYXRhLnVzZXIgfHxcbiAgICAgIChzZXNzaW9uRGF0YS51c2VyLnJvbGUgIT09IFwiYWRtaW5cIiAmJiBzZXNzaW9uRGF0YS51c2VyLnJvbGUgIT09IFwic3VwZXJBZG1pblwiKVxuICAgICkge1xuICAgICAgY29uc29sZS5sb2coYE1pZGRsZXdhcmU6IFVuYXV0aG9yaXplZCBhZG1pbiBhY2Nlc3MgdG8gJHtwYXRobmFtZX1gKTtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QobmV3IFVSTChcIi9hZG1pbi9sb2dpblwiLCByZXF1ZXN0LnVybCkpO1xuICAgIH1cbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLm5leHQoKTtcbiAgfVxuXG4gIC8vIDYpIEZvciBhbGwgb3RoZXIgcm91dGVzIG5vdCBjb3ZlcmVkIGFib3ZlLCB3ZSBjaGVjayBmb3IgYSBzZXNzaW9uIGNvb2tpZVxuICBjb25zdCBzZXNzaW9uQ29va2llID0gZ2V0U2Vzc2lvbkNvb2tpZShyZXF1ZXN0KTtcbiAgaWYgKCFzZXNzaW9uQ29va2llKSB7XG4gICAgY29uc29sZS5sb2coYE1pZGRsZXdhcmU6IE5vIHNlc3Npb24gY29va2llLCByZWRpcmVjdGluZyB0byAvbG9naW4gZnJvbSAke3BhdGhuYW1lfWApO1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QobmV3IFVSTChcIi9sb2dpblwiLCByZXF1ZXN0LnVybCkpO1xuICB9XG5cbiAgLy8gNykgVmFsaWRhdGUgdGhhdCBzZXNzaW9uIG9iamVjdCBpcyBjb3JyZWN0XG4gIGNvbnN0IHNlc3Npb25SZXMgPSBhd2FpdCBmZXRjaChuZXcgVVJMKFwiL2FwaS9hdXRoL2dldC1zZXNzaW9uXCIsIHJlcXVlc3QudXJsKSwge1xuICAgIGhlYWRlcnM6IHtcbiAgICAgIGNvb2tpZTogcmVxdWVzdC5oZWFkZXJzLmdldChcImNvb2tpZVwiKSB8fCBcIlwiLFxuICAgIH0sXG4gIH0pO1xuICBpZiAoIXNlc3Npb25SZXMub2spIHtcbiAgICBjb25zb2xlLmxvZyhgTWlkZGxld2FyZTogSW52YWxpZCBzZXNzaW9uLCByZWRpcmVjdGluZyB0byAvbG9naW4gZnJvbSAke3BhdGhuYW1lfWApO1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QobmV3IFVSTChcIi9sb2dpblwiLCByZXF1ZXN0LnVybCkpO1xuICB9XG5cbiAgLy8gSWYgdGhlIHNlc3Npb24gaXMgdmFsaWQsIHdlIGRvIE5PVCBjaGVjayB0aGUgYWN0aXZlT3JnYW5pemF0aW9uSWQgb3IgbWVtYmVyc2hpcCBoZXJlXG4gIC8vIGJlY2F1c2UgdGhhdCByZXF1aXJlcyBEQiBjYWxscyA9PiBub3Qgc3VwcG9ydGVkIGluIEVkZ2UgcnVudGltZS5cbiAgLy8gV2UnbGwgbGV0IGxheW91dC50c3ggaGFuZGxlIG1lbWJlcnNoaXAgJiBvcmcgY2hlY2tzLlxuXG4gIC8vIDgpIEV2ZXJ5dGhpbmcgZWxzZSBpcyBhbGxvd2VkXG4gIHJldHVybiBOZXh0UmVzcG9uc2UubmV4dCgpO1xufVxuXG5leHBvcnQgY29uc3QgY29uZmlnID0ge1xuICBtYXRjaGVyOiBcIi86cGF0aCpcIiwgLy8gQXBwbHkgbWlkZGxld2FyZSB0byBhbGwgcm91dGVzXG59O1xuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsImdldFNlc3Npb25Db29raWUiLCJtaWRkbGV3YXJlIiwicmVxdWVzdCIsInBhdGhuYW1lIiwibmV4dFVybCIsImNvbnNvbGUiLCJsb2ciLCJzdGFydHNXaXRoIiwiaW5jbHVkZXMiLCJuZXh0IiwicHVibGljUm91dGVzIiwiYWxsb3dlZFJvdXRlcyIsImlzQWxsb3dlZCIsInNvbWUiLCJyb3V0ZSIsInRva2VuIiwiaGVhZGVycyIsImdldCIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19JTlRFUk5BTF9UT0tFTiIsImpzb24iLCJlcnJvciIsInN0YXR1cyIsInNlc3Npb25SZXMiLCJmZXRjaCIsIlVSTCIsInVybCIsImNvb2tpZSIsIm9rIiwicmVkaXJlY3QiLCJzZXNzaW9uRGF0YSIsInVzZXIiLCJyb2xlIiwic2Vzc2lvbkNvb2tpZSIsImNvbmZpZyIsIm1hdGNoZXIiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(middleware)/./middleware.ts\n");

/***/ })

});