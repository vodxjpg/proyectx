"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("middleware",{

/***/ "(middleware)/./middleware.ts":
/*!***********************!*\
  !*** ./middleware.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   middleware: () => (/* binding */ middleware)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(middleware)/./node_modules/next/dist/esm/api/server.js\");\n/* harmony import */ var better_auth_cookies__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! better-auth/cookies */ \"(middleware)/./node_modules/better-auth/dist/cookies/index.mjs\");\n\n\n/**\n * IMPORTANT:\n * - We no longer check membership or activeOrganizationId here.\n * - We ONLY verify that the user has a valid session if they attempt\n *   to access private routes.\n */ async function middleware(request) {\n    const { pathname } = request.nextUrl;\n    console.log(\"Middleware: requested pathname\", pathname);\n    // 1) Allow static assets and files (e.g., CSS, JS, images)\n    if (pathname.startsWith(\"/_next\") || pathname.startsWith(\"/static\") || pathname.includes(\".\")) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n    }\n    // 2) Define public routes\n    const publicRoutes = [\n        \"/\",\n        \"/login\",\n        \"/signup\",\n        \"/forgot-password\",\n        \"/reset-password\",\n        \"/about-us\",\n        \"/api/auth\",\n        \"/api/auth/reset-password\",\n        \"/admin/login\",\n        \"/accept\",\n        \"/set-password\",\n        \"/accept-invitation\",\n        \"/accept-invite\",\n        \"/api/check-user\",\n        \"/api/create-user\",\n        \"/invite\",\n        \"/api/invite\",\n        \"/check-email\"\n    ];\n    // 3) Define allowed routes (public + onboarding + settings)\n    const allowedRoutes = [\n        ...publicRoutes,\n        \"/onboarding/organization\",\n        \"/onboarding/bot-keys\",\n        \"/onboarding/support-email\",\n        \"/onboarding/secret-phrase\",\n        \"/settings\",\n        \"/select-organization\"\n    ];\n    const isAllowed = allowedRoutes.some((route)=>pathname === route || pathname.startsWith(route + \"/\"));\n    console.log(`Middleware: Is ${pathname} allowed? ${isAllowed}`);\n    // If it's allowed, we don't force a session check\n    if (isAllowed) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n    }\n    // 4) For internal API endpoints, check the x-internal-token header\n    if (pathname.startsWith(\"/api/internal\")) {\n        const token = request.headers.get(\"x-internal-token\");\n        if (token !== \"Zx1pa3f6OEI02rxQFMaMDOpVM7VVtSkaa\") {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Unauthorized\"\n            }, {\n                status: 403\n            });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n    }\n    // 5) If accessing an admin route (other than /admin/login), verify full session and role\n    if (pathname.startsWith(\"/admin\") && pathname !== \"/admin/login\") {\n        const sessionRes = await fetch(new URL(\"/api/auth/get-session\", request.url), {\n            headers: {\n                cookie: request.headers.get(\"cookie\") || \"\"\n            }\n        });\n        if (!sessionRes.ok) {\n            console.log(`Middleware: Redirecting to /admin/login from ${pathname}`);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(\"/admin/login\", request.url));\n        }\n        const sessionData = await sessionRes.json();\n        if (!sessionData || !sessionData.user || sessionData.user.role !== \"admin\" && sessionData.user.role !== \"superAdmin\") {\n            console.log(`Middleware: Unauthorized admin access to ${pathname}`);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(\"/admin/login\", request.url));\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n    }\n    // 6) For all other routes not covered above, we check for a session cookie\n    const sessionCookie = (0,better_auth_cookies__WEBPACK_IMPORTED_MODULE_1__.getSessionCookie)(request);\n    if (!sessionCookie) {\n        console.log(`Middleware: No session cookie, redirecting to /login from ${pathname}`);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(\"/login\", request.url));\n    }\n    // 7) Validate that session object is correct\n    const sessionRes = await fetch(new URL(\"/api/auth/get-session\", request.url), {\n        headers: {\n            cookie: request.headers.get(\"cookie\") || \"\"\n        }\n    });\n    if (!sessionRes.ok) {\n        console.log(`Middleware: Invalid session, redirecting to /login from ${pathname}`);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(\"/login\", request.url));\n    }\n    // If the session is valid, we do NOT check the activeOrganizationId or membership here\n    // because that requires DB calls => not supported in Edge runtime.\n    // We'll let layout.tsx handle membership & org checks.\n    // 8) Everything else is allowed\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n}\nconst config = {\n    matcher: \"/:path*\"\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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VXhCLFFBQVF5QixHQUFHO0lBQzVEO0lBRUEsNkNBQTZDO0lBQzdDLE1BQU1ILGFBQWEsTUFBTUMsTUFBTSxJQUFJQyxJQUFJLHlCQUF5QnhCLFFBQVF5QixHQUFHLEdBQUc7UUFDNUVYLFNBQVM7WUFDUFksUUFBUTFCLFFBQVFjLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLGFBQWE7UUFDM0M7SUFDRjtJQUNBLElBQUksQ0FBQ08sV0FBV0ssRUFBRSxFQUFFO1FBQ2xCeEIsUUFBUUMsR0FBRyxDQUFDLENBQUMsd0RBQXdELEVBQUVILFNBQVMsQ0FBQztRQUNqRixPQUFPSixxREFBWUEsQ0FBQytCLFFBQVEsQ0FBQyxJQUFJSixJQUFJLFVBQVV4QixRQUFReUIsR0FBRztJQUM1RDtJQUVBLHVGQUF1RjtJQUN2RixtRUFBbUU7SUFDbkUsdURBQXVEO0lBRXZELGdDQUFnQztJQUNoQyxPQUFPNUIscURBQVlBLENBQUNVLElBQUk7QUFDMUI7QUFFTyxNQUFNMEIsU0FBUztJQUNwQkMsU0FBUztBQUNYLEVBQUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vbWlkZGxld2FyZS50cz80MjJkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tIFwibmV4dC9zZXJ2ZXJcIjtcbmltcG9ydCB7IGdldFNlc3Npb25Db29raWUgfSBmcm9tIFwiYmV0dGVyLWF1dGgvY29va2llc1wiO1xuXG4vKipcbiAqIElNUE9SVEFOVDpcbiAqIC0gV2Ugbm8gbG9uZ2VyIGNoZWNrIG1lbWJlcnNoaXAgb3IgYWN0aXZlT3JnYW5pemF0aW9uSWQgaGVyZS5cbiAqIC0gV2UgT05MWSB2ZXJpZnkgdGhhdCB0aGUgdXNlciBoYXMgYSB2YWxpZCBzZXNzaW9uIGlmIHRoZXkgYXR0ZW1wdFxuICogICB0byBhY2Nlc3MgcHJpdmF0ZSByb3V0ZXMuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBtaWRkbGV3YXJlKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIGNvbnN0IHsgcGF0aG5hbWUgfSA9IHJlcXVlc3QubmV4dFVybDtcblxuICBjb25zb2xlLmxvZyhcIk1pZGRsZXdhcmU6IHJlcXVlc3RlZCBwYXRobmFtZVwiLCBwYXRobmFtZSk7XG5cbiAgLy8gMSkgQWxsb3cgc3RhdGljIGFzc2V0cyBhbmQgZmlsZXMgKGUuZy4sIENTUywgSlMsIGltYWdlcylcbiAgaWYgKFxuICAgIHBhdGhuYW1lLnN0YXJ0c1dpdGgoXCIvX25leHRcIikgfHxcbiAgICBwYXRobmFtZS5zdGFydHNXaXRoKFwiL3N0YXRpY1wiKSB8fFxuICAgIHBhdGhuYW1lLmluY2x1ZGVzKFwiLlwiKVxuICApIHtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLm5leHQoKTtcbiAgfVxuXG4gIC8vIDIpIERlZmluZSBwdWJsaWMgcm91dGVzXG4gIGNvbnN0IHB1YmxpY1JvdXRlcyA9IFtcbiAgICBcIi9cIixcbiAgICBcIi9sb2dpblwiLFxuICAgIFwiL3NpZ251cFwiLFxuICAgIFwiL2ZvcmdvdC1wYXNzd29yZFwiLFxuICAgIFwiL3Jlc2V0LXBhc3N3b3JkXCIsXG4gICAgXCIvYWJvdXQtdXNcIixcbiAgICBcIi9hcGkvYXV0aFwiLFxuICAgIFwiL2FwaS9hdXRoL3Jlc2V0LXBhc3N3b3JkXCIsXG4gICAgXCIvYWRtaW4vbG9naW5cIixcbiAgICBcIi9hY2NlcHRcIiwgICAgICAgICAgICAgLy8gRm9yIC9hY2NlcHQvW2ludml0YXRpb25JZF1cbiAgICBcIi9zZXQtcGFzc3dvcmRcIiwgICAgICAgLy8gRm9yIG5ldyB1c2VycyB0byBzZXQgdGhlaXIgcGFzc3dvcmRcbiAgICBcIi9hY2NlcHQtaW52aXRhdGlvblwiLCAgLy8gQ292ZXJzIC9hY2NlcHQtaW52aXRhdGlvbi9baW52aXRhdGlvbklkXVxuICAgIFwiL2FjY2VwdC1pbnZpdGVcIiwgICAgICAvLyBDb25maXJtYXRpb24gcGFnZVxuICAgIFwiL2FwaS9jaGVjay11c2VyXCIsICAgICAvLyBBUEkgdG8gY2hlY2sgaWYgdXNlciBleGlzdHNcbiAgICBcIi9hcGkvY3JlYXRlLXVzZXJcIiwgICAgLy8gQVBJIHRvIGNyZWF0ZSB1c2Vyc1xuICAgIFwiL2ludml0ZVwiLCAgICAgICAgICAgICAvLyBDb3ZlcnMgL2ludml0ZS9baW52aXRhdGlvbklkXVxuICAgIFwiL2FwaS9pbnZpdGVcIixcbiAgICBcIi9jaGVjay1lbWFpbFwiLCAgICAgICAgLy8gQWxsb3cgQVBJIGNhbGxzIGZvciBpbnZpdGF0aW9uc1xuICBdO1xuXG4gIC8vIDMpIERlZmluZSBhbGxvd2VkIHJvdXRlcyAocHVibGljICsgb25ib2FyZGluZyArIHNldHRpbmdzKVxuICBjb25zdCBhbGxvd2VkUm91dGVzID0gW1xuICAgIC4uLnB1YmxpY1JvdXRlcyxcbiAgICBcIi9vbmJvYXJkaW5nL29yZ2FuaXphdGlvblwiLFxuICAgIFwiL29uYm9hcmRpbmcvYm90LWtleXNcIixcbiAgICBcIi9vbmJvYXJkaW5nL3N1cHBvcnQtZW1haWxcIixcbiAgICBcIi9vbmJvYXJkaW5nL3NlY3JldC1waHJhc2VcIixcbiAgICBcIi9zZXR0aW5nc1wiLFxuICAgIFwiL3NlbGVjdC1vcmdhbml6YXRpb25cIiwgLy8gV2UgYWxsb3cgZGlyZWN0IGFjY2VzcyB0byBzZWxlY3Qtb3JnYW5pemF0aW9uIHBhZ2VcbiAgXTtcblxuICBjb25zdCBpc0FsbG93ZWQgPSBhbGxvd2VkUm91dGVzLnNvbWUoXG4gICAgKHJvdXRlKSA9PiBwYXRobmFtZSA9PT0gcm91dGUgfHwgcGF0aG5hbWUuc3RhcnRzV2l0aChyb3V0ZSArIFwiL1wiKVxuICApO1xuXG4gIGNvbnNvbGUubG9nKGBNaWRkbGV3YXJlOiBJcyAke3BhdGhuYW1lfSBhbGxvd2VkPyAke2lzQWxsb3dlZH1gKTtcbiAgLy8gSWYgaXQncyBhbGxvd2VkLCB3ZSBkb24ndCBmb3JjZSBhIHNlc3Npb24gY2hlY2tcbiAgaWYgKGlzQWxsb3dlZCkge1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UubmV4dCgpO1xuICB9XG5cbiAgLy8gNCkgRm9yIGludGVybmFsIEFQSSBlbmRwb2ludHMsIGNoZWNrIHRoZSB4LWludGVybmFsLXRva2VuIGhlYWRlclxuICBpZiAocGF0aG5hbWUuc3RhcnRzV2l0aChcIi9hcGkvaW50ZXJuYWxcIikpIHtcbiAgICBjb25zdCB0b2tlbiA9IHJlcXVlc3QuaGVhZGVycy5nZXQoXCJ4LWludGVybmFsLXRva2VuXCIpO1xuICAgIGlmICh0b2tlbiAhPT0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfSU5URVJOQUxfVE9LRU4pIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBcIlVuYXV0aG9yaXplZFwiIH0sIHsgc3RhdHVzOiA0MDMgfSk7XG4gICAgfVxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UubmV4dCgpO1xuICB9XG5cbiAgLy8gNSkgSWYgYWNjZXNzaW5nIGFuIGFkbWluIHJvdXRlIChvdGhlciB0aGFuIC9hZG1pbi9sb2dpbiksIHZlcmlmeSBmdWxsIHNlc3Npb24gYW5kIHJvbGVcbiAgaWYgKHBhdGhuYW1lLnN0YXJ0c1dpdGgoXCIvYWRtaW5cIikgJiYgcGF0aG5hbWUgIT09IFwiL2FkbWluL2xvZ2luXCIpIHtcbiAgICBjb25zdCBzZXNzaW9uUmVzID0gYXdhaXQgZmV0Y2gobmV3IFVSTChcIi9hcGkvYXV0aC9nZXQtc2Vzc2lvblwiLCByZXF1ZXN0LnVybCksIHtcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgY29va2llOiByZXF1ZXN0LmhlYWRlcnMuZ2V0KFwiY29va2llXCIpIHx8IFwiXCIsXG4gICAgICB9LFxuICAgIH0pO1xuICAgIGlmICghc2Vzc2lvblJlcy5vaykge1xuICAgICAgY29uc29sZS5sb2coYE1pZGRsZXdhcmU6IFJlZGlyZWN0aW5nIHRvIC9hZG1pbi9sb2dpbiBmcm9tICR7cGF0aG5hbWV9YCk7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJlZGlyZWN0KG5ldyBVUkwoXCIvYWRtaW4vbG9naW5cIiwgcmVxdWVzdC51cmwpKTtcbiAgICB9XG4gICAgY29uc3Qgc2Vzc2lvbkRhdGEgPSBhd2FpdCBzZXNzaW9uUmVzLmpzb24oKTtcbiAgICBpZiAoXG4gICAgICAhc2Vzc2lvbkRhdGEgfHxcbiAgICAgICFzZXNzaW9uRGF0YS51c2VyIHx8XG4gICAgICAoc2Vzc2lvbkRhdGEudXNlci5yb2xlICE9PSBcImFkbWluXCIgJiYgc2Vzc2lvbkRhdGEudXNlci5yb2xlICE9PSBcInN1cGVyQWRtaW5cIilcbiAgICApIHtcbiAgICAgIGNvbnNvbGUubG9nKGBNaWRkbGV3YXJlOiBVbmF1dGhvcml6ZWQgYWRtaW4gYWNjZXNzIHRvICR7cGF0aG5hbWV9YCk7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJlZGlyZWN0KG5ldyBVUkwoXCIvYWRtaW4vbG9naW5cIiwgcmVxdWVzdC51cmwpKTtcbiAgICB9XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5uZXh0KCk7XG4gIH1cblxuICAvLyA2KSBGb3IgYWxsIG90aGVyIHJvdXRlcyBub3QgY292ZXJlZCBhYm92ZSwgd2UgY2hlY2sgZm9yIGEgc2Vzc2lvbiBjb29raWVcbiAgY29uc3Qgc2Vzc2lvbkNvb2tpZSA9IGdldFNlc3Npb25Db29raWUocmVxdWVzdCk7XG4gIGlmICghc2Vzc2lvbkNvb2tpZSkge1xuICAgIGNvbnNvbGUubG9nKGBNaWRkbGV3YXJlOiBObyBzZXNzaW9uIGNvb2tpZSwgcmVkaXJlY3RpbmcgdG8gL2xvZ2luIGZyb20gJHtwYXRobmFtZX1gKTtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJlZGlyZWN0KG5ldyBVUkwoXCIvbG9naW5cIiwgcmVxdWVzdC51cmwpKTtcbiAgfVxuXG4gIC8vIDcpIFZhbGlkYXRlIHRoYXQgc2Vzc2lvbiBvYmplY3QgaXMgY29ycmVjdFxuICBjb25zdCBzZXNzaW9uUmVzID0gYXdhaXQgZmV0Y2gobmV3IFVSTChcIi9hcGkvYXV0aC9nZXQtc2Vzc2lvblwiLCByZXF1ZXN0LnVybCksIHtcbiAgICBoZWFkZXJzOiB7XG4gICAgICBjb29raWU6IHJlcXVlc3QuaGVhZGVycy5nZXQoXCJjb29raWVcIikgfHwgXCJcIixcbiAgICB9LFxuICB9KTtcbiAgaWYgKCFzZXNzaW9uUmVzLm9rKSB7XG4gICAgY29uc29sZS5sb2coYE1pZGRsZXdhcmU6IEludmFsaWQgc2Vzc2lvbiwgcmVkaXJlY3RpbmcgdG8gL2xvZ2luIGZyb20gJHtwYXRobmFtZX1gKTtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJlZGlyZWN0KG5ldyBVUkwoXCIvbG9naW5cIiwgcmVxdWVzdC51cmwpKTtcbiAgfVxuXG4gIC8vIElmIHRoZSBzZXNzaW9uIGlzIHZhbGlkLCB3ZSBkbyBOT1QgY2hlY2sgdGhlIGFjdGl2ZU9yZ2FuaXphdGlvbklkIG9yIG1lbWJlcnNoaXAgaGVyZVxuICAvLyBiZWNhdXNlIHRoYXQgcmVxdWlyZXMgREIgY2FsbHMgPT4gbm90IHN1cHBvcnRlZCBpbiBFZGdlIHJ1bnRpbWUuXG4gIC8vIFdlJ2xsIGxldCBsYXlvdXQudHN4IGhhbmRsZSBtZW1iZXJzaGlwICYgb3JnIGNoZWNrcy5cblxuICAvLyA4KSBFdmVyeXRoaW5nIGVsc2UgaXMgYWxsb3dlZFxuICByZXR1cm4gTmV4dFJlc3BvbnNlLm5leHQoKTtcbn1cblxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IHtcbiAgbWF0Y2hlcjogXCIvOnBhdGgqXCIsIC8vIEFwcGx5IG1pZGRsZXdhcmUgdG8gYWxsIHJvdXRlc1xufTtcbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJnZXRTZXNzaW9uQ29va2llIiwibWlkZGxld2FyZSIsInJlcXVlc3QiLCJwYXRobmFtZSIsIm5leHRVcmwiLCJjb25zb2xlIiwibG9nIiwic3RhcnRzV2l0aCIsImluY2x1ZGVzIiwibmV4dCIsInB1YmxpY1JvdXRlcyIsImFsbG93ZWRSb3V0ZXMiLCJpc0FsbG93ZWQiLCJzb21lIiwicm91dGUiLCJ0b2tlbiIsImhlYWRlcnMiLCJnZXQiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfSU5URVJOQUxfVE9LRU4iLCJqc29uIiwiZXJyb3IiLCJzdGF0dXMiLCJzZXNzaW9uUmVzIiwiZmV0Y2giLCJVUkwiLCJ1cmwiLCJjb29raWUiLCJvayIsInJlZGlyZWN0Iiwic2Vzc2lvbkRhdGEiLCJ1c2VyIiwicm9sZSIsInNlc3Npb25Db29raWUiLCJjb25maWciLCJtYXRjaGVyIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(middleware)/./middleware.ts\n");

/***/ })

});