/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/products/route";
exports.ids = ["app/api/products/route"];
exports.modules = {

/***/ "(rsc)/./node_modules/mysql2/lib sync recursive ^cardinal.*$":
/*!****************************************************!*\
  !*** ./node_modules/mysql2/lib/ sync ^cardinal.*$ ***!
  \****************************************************/
/***/ ((module) => {

function webpackEmptyContext(req) {
	var e = new Error("Cannot find module '" + req + "'");
	e.code = 'MODULE_NOT_FOUND';
	throw e;
}
webpackEmptyContext.keys = () => ([]);
webpackEmptyContext.resolve = webpackEmptyContext;
webpackEmptyContext.id = "(rsc)/./node_modules/mysql2/lib sync recursive ^cardinal.*$";
module.exports = webpackEmptyContext;

/***/ }),

/***/ "better-sqlite3":
/*!*********************************!*\
  !*** external "better-sqlite3" ***!
  \*********************************/
/***/ ((module) => {

"use strict";
module.exports = require("better-sqlite3");

/***/ }),

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("buffer");

/***/ }),

/***/ "child_process":
/*!********************************!*\
  !*** external "child_process" ***!
  \********************************/
/***/ ((module) => {

"use strict";
module.exports = require("child_process");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "dns":
/*!**********************!*\
  !*** external "dns" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("dns");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("events");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

"use strict";
module.exports = require("https");

/***/ }),

/***/ "net":
/*!**********************!*\
  !*** external "net" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("net");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("path");

/***/ }),

/***/ "process":
/*!**************************!*\
  !*** external "process" ***!
  \**************************/
/***/ ((module) => {

"use strict";
module.exports = require("process");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("stream");

/***/ }),

/***/ "string_decoder":
/*!*********************************!*\
  !*** external "string_decoder" ***!
  \*********************************/
/***/ ((module) => {

"use strict";
module.exports = require("string_decoder");

/***/ }),

/***/ "timers":
/*!*************************!*\
  !*** external "timers" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("timers");

/***/ }),

/***/ "tls":
/*!**********************!*\
  !*** external "tls" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("tls");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("zlib");

/***/ }),

/***/ "node:buffer":
/*!******************************!*\
  !*** external "node:buffer" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:buffer");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:crypto");

/***/ }),

/***/ "node:events":
/*!******************************!*\
  !*** external "node:events" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:events");

/***/ }),

/***/ "node:http":
/*!****************************!*\
  !*** external "node:http" ***!
  \****************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:http");

/***/ }),

/***/ "node:https":
/*!*****************************!*\
  !*** external "node:https" ***!
  \*****************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:https");

/***/ }),

/***/ "node:util":
/*!****************************!*\
  !*** external "node:util" ***!
  \****************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:util");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fproducts%2Froute&page=%2Fapi%2Fproducts%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fproducts%2Froute.ts&appDir=%2Fhome%2Fzodx%2FDesktop%2Fproyectx%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fzodx%2FDesktop%2Fproyectx&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fproducts%2Froute&page=%2Fapi%2Fproducts%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fproducts%2Froute.ts&appDir=%2Fhome%2Fzodx%2FDesktop%2Fproyectx%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fzodx%2FDesktop%2Fproyectx&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _home_zodx_Desktop_proyectx_app_api_products_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/products/route.ts */ \"(rsc)/./app/api/products/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/products/route\",\n        pathname: \"/api/products\",\n        filename: \"route\",\n        bundlePath: \"app/api/products/route\"\n    },\n    resolvedPagePath: \"/home/zodx/Desktop/proyectx/app/api/products/route.ts\",\n    nextConfigOutput,\n    userland: _home_zodx_Desktop_proyectx_app_api_products_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/products/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZwcm9kdWN0cyUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGcHJvZHVjdHMlMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZwcm9kdWN0cyUyRnJvdXRlLnRzJmFwcERpcj0lMkZob21lJTJGem9keCUyRkRlc2t0b3AlMkZwcm95ZWN0eCUyRmFwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9JTJGaG9tZSUyRnpvZHglMkZEZXNrdG9wJTJGcHJveWVjdHgmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ0s7QUFDbEY7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90cmFwaWdyYW0vPzM0ZTciXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiL2hvbWUvem9keC9EZXNrdG9wL3Byb3llY3R4L2FwcC9hcGkvcHJvZHVjdHMvcm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3Byb2R1Y3RzL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvcHJvZHVjdHNcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL3Byb2R1Y3RzL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL2hvbWUvem9keC9EZXNrdG9wL3Byb3llY3R4L2FwcC9hcGkvcHJvZHVjdHMvcm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL3Byb2R1Y3RzL3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fproducts%2Froute&page=%2Fapi%2Fproducts%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fproducts%2Froute.ts&appDir=%2Fhome%2Fzodx%2FDesktop%2Fproyectx%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fzodx%2FDesktop%2Fproyectx&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/products/route.ts":
/*!***********************************!*\
  !*** ./app/api/products/route.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _utils_auth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/utils/auth */ \"(rsc)/./utils/auth.ts\");\n/* harmony import */ var _utils_db__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/utils/db */ \"(rsc)/./utils/db.ts\");\n\n\n\n/** Helper to get organization ID from session */ async function getOrgIdOrThrow(req) {\n    const sessionResponse = await _utils_auth__WEBPACK_IMPORTED_MODULE_1__.auth.api.getSession({\n        headers: req.headers\n    });\n    if (!sessionResponse || !sessionResponse.session) {\n        throw new Error(\"Unauthorized\");\n    }\n    const activeOrgId = sessionResponse.session.activeOrganizationId;\n    if (!activeOrgId) throw new Error(\"No active organization in session\");\n    return activeOrgId;\n}\n/**\n * GET /api/products\n *\n * Behavior:\n *  - If no query params: returns all parent products (simple or variable) with:\n *      id, name, sku, type, imageURL, categories[], plus an \"aggregatedStock\" summary\n *      (totalStock), and for variable products: variableMinPrice & variableMaxPrice\n *\n *  - If query param ?id=xxx or ?sku=xxx: returns details for that single product,\n *      including:\n *        - product-level fields\n *        - categories\n *        - an array of all variants (for variable), each with stock lines\n *        - or the single variant + stock lines (for simple)\n */ async function GET(req) {\n    try {\n        const organizationId = await getOrgIdOrThrow(req);\n        // Extract search params: ?id=xxx or ?sku=xxx\n        const { searchParams } = new URL(req.url);\n        const paramId = searchParams.get(\"id\");\n        const paramSku = searchParams.get(\"sku\");\n        // If user provided ?id or ?sku, we do \"getOneProductDetail\"\n        if (paramId || paramSku) {\n            return await getOneProductDetail(organizationId, paramId, paramSku);\n        }\n        // Otherwise, we return the entire list of parent products with partial details\n        return await getAllParentProducts(organizationId);\n    } catch (error) {\n        console.error(\"[GET] /api/products Error:\", error.message);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: error.message\n        }, {\n            status: error.message === \"Unauthorized\" ? 401 : 400\n        });\n    }\n}\n/** =========================================\n *  getAllParentProducts(organizationId)\n *    Returns an array of products with:\n *      - product fields: id, name, type, sku, imageURL, ...\n *      - categories[] array\n *      - totalStock (sum of all variant stock)\n *      - variableMinPrice & variableMaxPrice for variable products\n * =========================================*/ async function getAllParentProducts(organizationId) {\n    // 1) Fetch the parent products\n    const products = await _utils_db__WEBPACK_IMPORTED_MODULE_2__.db.selectFrom(\"product as p\").select([\n        \"p.id\",\n        \"p.name\",\n        \"p.type\",\n        \"p.sku\",\n        \"p.price\",\n        \"p.status\",\n        \"p.imageURL\",\n        \"p.createdAt\",\n        \"p.updatedAt\"\n    ]).where(\"p.organizationId\", \"=\", organizationId).orderBy(\"p.createdAt\", \"desc\").execute();\n    const productIds = products.map((p)=>p.id);\n    // 2) Fetch all category assignments in bulk\n    //    We then group by productId\n    const categoryAssignments = await _utils_db__WEBPACK_IMPORTED_MODULE_2__.db.selectFrom(\"product_category_assignments as pca\").innerJoin(\"product_categories as c\", \"c.id\", \"pca.categoryId\").select([\n        \"pca.productId\",\n        \"c.id as categoryId\",\n        \"c.name as categoryName\",\n        \"c.parentId as categoryParent\"\n    ]).where(\"pca.organizationId\", \"=\", organizationId).where(\"pca.productId\", \"in\", productIds).execute();\n    const categoriesByProductId = {};\n    for (const ca of categoryAssignments){\n        if (!categoriesByProductId[ca.productId]) {\n            categoriesByProductId[ca.productId] = [];\n        }\n        categoriesByProductId[ca.productId].push({\n            categoryId: ca.categoryId,\n            categoryName: ca.categoryName,\n            categoryParent: ca.categoryParent\n        });\n    }\n    // 3) For each product, we want an aggregated stock approach\n    //    We'll fetch from product_variants => product_stock\n    //    Summing all stock if it's variable, or just the single variant if simple\n    //    Then group by productId\n    const variantRows = await _utils_db__WEBPACK_IMPORTED_MODULE_2__.db.selectFrom(\"product_variants as pv\").leftJoin(\"product_stock as ps\", \"ps.variantId\", \"pv.id\").select([\n        \"pv.productId\",\n        \"pv.id as variantId\",\n        \"pv.sku as variantSku\",\n        \"pv.price as variantPrice\",\n        \"ps.stockLevel\",\n        \"ps.visibility\",\n        \"ps.manageStock\",\n        \"ps.allowBackorder\"\n    ]).where(\"pv.organizationId\", \"=\", organizationId).where(\"pv.productId\", \"in\", productIds).execute();\n    // We'll accumulate totalStock per product, and also track\n    // min/max variant price for variable products\n    const aggregatedStockByProductId = {};\n    // minPrice / maxPrice for variable\n    const minPriceByProductId = {};\n    const maxPriceByProductId = {};\n    for (const vr of variantRows){\n        const pid = vr.productId;\n        if (!aggregatedStockByProductId[pid]) {\n            aggregatedStockByProductId[pid] = 0;\n        }\n        aggregatedStockByProductId[pid] += vr.stockLevel || 0;\n        // For variable min/max, we check variantPrice\n        // We'll just always track min/max for every variant,\n        // though for simple products there's only 1 variant anyway\n        const vPrice = vr.variantPrice || 0;\n        if (minPriceByProductId[pid] === undefined) {\n            minPriceByProductId[pid] = vPrice;\n            maxPriceByProductId[pid] = vPrice;\n        } else {\n            if (vPrice < minPriceByProductId[pid]) {\n                minPriceByProductId[pid] = vPrice;\n            }\n            if (vPrice > maxPriceByProductId[pid]) {\n                maxPriceByProductId[pid] = vPrice;\n            }\n        }\n    }\n    // 4) Construct final array of product data\n    const final = products.map((p)=>{\n        const totalStock = aggregatedStockByProductId[p.id] || 0;\n        const cats = categoriesByProductId[p.id] || [];\n        // If this is a variable product, we put\n        //   variableMinPrice, variableMaxPrice\n        //   otherwise for simple we have p.price\n        let variableMinPrice = null;\n        let variableMaxPrice = null;\n        if (p.type === \"variable\") {\n            // fallback if no variants => 0\n            variableMinPrice = minPriceByProductId[p.id] || 0;\n            variableMaxPrice = maxPriceByProductId[p.id] || 0;\n        }\n        return {\n            id: p.id,\n            name: p.name,\n            type: p.type,\n            sku: p.sku,\n            status: p.status,\n            imageURL: p.imageURL,\n            // For simple products, 'price' is stored on p.price\n            // For variable, we do min/max\n            price: p.price,\n            variableMinPrice,\n            variableMaxPrice,\n            totalStock,\n            categories: cats\n        };\n    });\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(final, {\n        status: 200\n    });\n}\n/** =========================================\n *  getOneProductDetail(organizationId, id?, sku?)\n *    Returns a single product *with all details*:\n *      - product fields\n *      - categories\n *      - an array of variants (even for simple => 1 variant)\n *        each variant has stock lines\n * =========================================*/ async function getOneProductDetail(organizationId, productId, productSku) {\n    // 1) Find the product row by ID or SKU\n    let product;\n    if (productId) {\n        product = await _utils_db__WEBPACK_IMPORTED_MODULE_2__.db.selectFrom(\"product\").selectAll().where(\"organizationId\", \"=\", organizationId).where(\"id\", \"=\", productId).executeTakeFirst();\n    } else if (productSku) {\n        product = await _utils_db__WEBPACK_IMPORTED_MODULE_2__.db.selectFrom(\"product\").selectAll().where(\"organizationId\", \"=\", organizationId).where(\"sku\", \"=\", productSku).executeTakeFirst();\n    }\n    if (!product) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Product not found\"\n        }, {\n            status: 404\n        });\n    }\n    const pid = product.id;\n    // 2) Get categories for this product\n    const categories = await _utils_db__WEBPACK_IMPORTED_MODULE_2__.db.selectFrom(\"product_category_assignments as pca\").innerJoin(\"product_categories as c\", \"c.id\", \"pca.categoryId\").select([\n        \"c.id as categoryId\",\n        \"c.name as categoryName\",\n        \"c.parentId as categoryParent\",\n        \"c.slug as categorySlug\"\n    ]).where(\"pca.productId\", \"=\", pid).where(\"pca.organizationId\", \"=\", organizationId).execute();\n    // 3) Fetch all variants for this product (including simple => 1 variant)\n    const variants = await _utils_db__WEBPACK_IMPORTED_MODULE_2__.db.selectFrom(\"product_variants as pv\").selectAll().where(\"pv.productId\", \"=\", pid).where(\"pv.organizationId\", \"=\", organizationId).execute();\n    // 4) For each variant, fetch stock lines\n    const variantIds = variants.map((v)=>v.id);\n    let allStock = [];\n    if (variantIds.length > 0) {\n        allStock = await _utils_db__WEBPACK_IMPORTED_MODULE_2__.db.selectFrom(\"product_stock as ps\").selectAll().where(\"ps.variantId\", \"in\", variantIds).where(\"ps.organizationId\", \"=\", organizationId).execute();\n    }\n    // Group stock by variantId\n    const stockByVariantId = {};\n    for (const s of allStock){\n        if (!stockByVariantId[s.variantId]) {\n            stockByVariantId[s.variantId] = [];\n        }\n        stockByVariantId[s.variantId].push(s);\n    }\n    // 5) Combine variant + stock\n    //    Also fetch variant terms if you want fully detailed attribute/term usage\n    const variantTermsRows = await _utils_db__WEBPACK_IMPORTED_MODULE_2__.db.selectFrom(\"product_variant_terms as pvt\").innerJoin(\"product_attribute_terms as pat\", \"pat.id\", \"pvt.termId\").select([\n        \"pvt.variantId\",\n        \"pat.attributeId\",\n        \"pat.name as termName\",\n        \"pat.slug as termSlug\"\n    ]).where(\"pvt.variantId\", \"in\", variantIds).where(\"pvt.organizationId\", \"=\", organizationId).execute();\n    const termsByVariantId = {};\n    for (const vt of variantTermsRows){\n        if (!termsByVariantId[vt.variantId]) {\n            termsByVariantId[vt.variantId] = [];\n        }\n        termsByVariantId[vt.variantId].push({\n            attributeId: vt.attributeId,\n            name: vt.termName,\n            slug: vt.termSlug\n        });\n    }\n    const variantsWithStock = variants.map((v)=>({\n            ...v,\n            stock: stockByVariantId[v.id] || [],\n            terms: termsByVariantId[v.id] || []\n        }));\n    // 6) Optionally fetch \"attribute assignments\" for the parent product\n    const attributeAssignments = await _utils_db__WEBPACK_IMPORTED_MODULE_2__.db.selectFrom(\"product_attribute_assignments as paa\").innerJoin(\"product_attributes as pa\", \"pa.id\", \"paa.attributeId\").leftJoin(\"product_term as pt\", (join)=>{\n        join.onRef(\"pt.productId\", \"=\", \"paa.productId\").onRef(\"pt.attributeId\", \"=\", \"paa.attributeId\");\n    }).leftJoin(\"product_attribute_terms as pat2\", \"pat2.id\", \"pt.termId\").select([\n        \"paa.attributeId\",\n        \"paa.usedForVariation\",\n        \"pa.name as attributeName\",\n        \"pa.slug as attributeSlug\",\n        \"pat2.id as termId\",\n        \"pat2.name as termName\",\n        \"pat2.slug as termSlug\"\n    ]).where(\"paa.productId\", \"=\", pid).where(\"paa.organizationId\", \"=\", organizationId).execute();\n    const attrsById = {};\n    for (const row of attributeAssignments){\n        const aId = row.attributeId;\n        if (!attrsById[aId]) {\n            attrsById[aId] = {\n                attributeId: aId,\n                usedForVariation: !!row.usedForVariation,\n                attributeName: row.attributeName,\n                attributeSlug: row.attributeSlug,\n                terms: []\n            };\n        }\n        if (row.termId) {\n            attrsById[aId].terms.push({\n                id: row.termId,\n                name: row.termName,\n                slug: row.termSlug\n            });\n        }\n    }\n    const productAttributes = Object.values(attrsById);\n    // 7) Build final single-product response\n    const fullProduct = {\n        ...product,\n        categories,\n        attributes: productAttributes,\n        variants: variantsWithStock\n    };\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(fullProduct, {\n        status: 200\n    });\n}\nasync function POST(req) {\n    try {\n        // Get organization ID from session\n        const organizationId = await getOrgIdOrThrow(req);\n        console.log(\"[POST] organizationId:\", organizationId);\n        // Parse incoming payload\n        const { name, description, type, sku, price, status, categories, attributes, variations, stock, imageURL } = await req.json();\n        console.log(\"[POST] Received payload:\", {\n            name,\n            description,\n            type,\n            sku,\n            price,\n            status,\n            categories,\n            attributes,\n            variations,\n            stock,\n            imageURL\n        });\n        if (!name || !type || !status) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Name, type, and status are required\"\n            }, {\n                status: 400\n            });\n        }\n        const id = crypto.randomUUID();\n        const createdAt = new Date().toISOString();\n        const updatedAt = createdAt;\n        console.log(\"[POST] New product ID:\", id);\n        // Start transaction\n        const product = await _utils_db__WEBPACK_IMPORTED_MODULE_2__.db.transaction().execute(async (trx)=>{\n            // 1) Insert product\n            const productValues = {\n                id,\n                organizationId,\n                name,\n                description,\n                type,\n                // We store parent SKU only if simple,\n                // but you previously changed to allow SKU for any product. If so, remove the conditional below:\n                sku: type === \"simple\" ? sku : sku,\n                price: type === \"simple\" ? price : null,\n                status,\n                createdAt,\n                updatedAt,\n                imageURL: imageURL || null\n            };\n            console.log(\"[POST] Inserting product with values:\", productValues);\n            const insertedProduct = await trx.insertInto(\"product\").values(productValues).returningAll().executeTakeFirstOrThrow();\n            console.log(\"[POST] Inserted product:\", insertedProduct);\n            // 2) Insert category assignments\n            if (categories && categories.length > 0) {\n                const categoryAssignments = categories.map((categoryId)=>({\n                        id: crypto.randomUUID(),\n                        productId: id,\n                        categoryId,\n                        organizationId\n                    }));\n                console.log(\"[POST] Inserting category assignments:\", categoryAssignments);\n                await trx.insertInto(\"product_category_assignments\").values(categoryAssignments).execute();\n            }\n            // 3) Insert attribute assignments and product terms for non-variation attributes\n            if (attributes && attributes.length > 0) {\n                // Log a lookup for each attribute to confirm existence and organization\n                for (const attr of attributes){\n                    const dbAttr = await trx.selectFrom(\"product_attributes\").selectAll().where(\"id\", \"=\", attr.attributeId).executeTakeFirst();\n                    console.log(\"[POST] Lookup attribute:\", attr.attributeId, dbAttr);\n                    if (!dbAttr) {\n                        throw new Error(`Attribute ${attr.attributeId} not found in product_attributes`);\n                    }\n                    // Optional: Check if dbAttr.organizationId matches organizationId\n                    if (dbAttr.organizationId !== organizationId) {\n                        throw new Error(`Attribute ${attr.attributeId} organization mismatch. Expected ${organizationId} but got ${dbAttr.organizationId}`);\n                    }\n                }\n                const attributeAssignments = attributes.map((attr)=>({\n                        id: crypto.randomUUID(),\n                        productId: id,\n                        attributeId: attr.attributeId,\n                        usedForVariation: type === \"variable\" && attr.usedForVariation ? 1 : 0,\n                        organizationId\n                    }));\n                console.log(\"[POST] Inserting attribute assignments:\", attributeAssignments);\n                await trx.insertInto(\"product_attribute_assignments\").values(attributeAssignments).execute();\n                // Insert terms for attributes not used for variation (if any)\n                const terms = attributes.filter((attr)=>!attr.usedForVariation || type === \"simple\").flatMap((attr)=>attr.terms.map((termId)=>({\n                            id: crypto.randomUUID(),\n                            productId: id,\n                            attributeId: attr.attributeId,\n                            termId,\n                            organizationId\n                        })));\n                if (terms.length > 0) {\n                    console.log(\"[POST] Inserting product terms:\", terms);\n                    await trx.insertInto(\"product_term\").values(terms).execute();\n                }\n            }\n            // 4) Insert variants (and their variant terms and stock)\n            if (type === \"variable\" && variations && variations.length > 0) {\n                const variantInserts = variations.map((variant)=>({\n                        id: crypto.randomUUID(),\n                        productId: id,\n                        organizationId,\n                        sku: variant.sku,\n                        price: variant.price,\n                        createdAt,\n                        updatedAt,\n                        imageURL: variant.imageURL || null\n                    }));\n                console.log(\"[POST] Inserting variants:\", variantInserts);\n                const insertedVariants = await trx.insertInto(\"product_variants\").values(variantInserts).returning([\n                    \"id\"\n                ]).execute();\n                console.log(\"[POST] Inserted variants:\", insertedVariants);\n                // Insert variant terms\n                const variantTerms = variations.flatMap((variant, index)=>variant.terms.map((term)=>({\n                            id: crypto.randomUUID(),\n                            variantId: insertedVariants[index].id,\n                            attributeId: term.attributeId,\n                            termId: term.termId,\n                            organizationId\n                        })));\n                console.log(\"[POST] Prepared variant terms:\", variantTerms);\n                if (variantTerms.length > 0) {\n                    await trx.insertInto(\"product_variant_terms\").values(variantTerms).execute();\n                    console.log(\"[POST] Inserted variant terms\");\n                }\n                // Insert stock for each variation\n                for(let i = 0; i < variations.length; i++){\n                    const variation = variations[i];\n                    const variantId = insertedVariants[i].id;\n                    if (variation.stock && variation.stock.length > 0) {\n                        const stockInserts = variation.stock.map((stk)=>({\n                                id: crypto.randomUUID(),\n                                variantId,\n                                countryCode: stk.countryCode,\n                                stockLevel: stk.manageStock ? stk.stockLevel || 0 : 999999999,\n                                visibility: stk.visibility ? 1 : 0,\n                                manageStock: stk.manageStock ? 1 : 0,\n                                allowBackorder: stk.allowBackorder ? 1 : 0,\n                                organizationId\n                            }));\n                        console.log(`[POST] Inserting/upserting stock for variant ${variantId}:`, stockInserts);\n                        for (const s of stockInserts){\n                            await trx.insertInto(\"product_stock\").values(s).onConflict((oc)=>oc.columns([\n                                    \"variantId\",\n                                    \"countryCode\"\n                                ]).doUpdateSet({\n                                    stockLevel: s.stockLevel,\n                                    visibility: s.visibility,\n                                    manageStock: s.manageStock,\n                                    allowBackorder: s.allowBackorder\n                                })).execute();\n                        }\n                    }\n                }\n            } else {\n                // SIMPLE PRODUCT => Insert a single variant\n                const variantId = crypto.randomUUID();\n                const simpleVariant = {\n                    id: variantId,\n                    productId: id,\n                    organizationId,\n                    sku,\n                    price,\n                    createdAt,\n                    updatedAt,\n                    imageURL: imageURL || null\n                };\n                console.log(\"[POST] Inserting simple variant:\", simpleVariant);\n                await trx.insertInto(\"product_variants\").values([\n                    simpleVariant\n                ]).execute();\n                // Insert stock for simple product\n                if (stock && stock.length > 0) {\n                    const stockInserts = stock.map((stk)=>({\n                            id: crypto.randomUUID(),\n                            variantId,\n                            countryCode: stk.countryCode,\n                            stockLevel: stk.manageStock ? stk.stockLevel || 0 : 999999999,\n                            visibility: stk.visibility ? 1 : 0,\n                            manageStock: stk.manageStock ? 1 : 0,\n                            allowBackorder: stk.allowBackorder ? 1 : 0,\n                            organizationId\n                        }));\n                    console.log(\"[POST] Inserting/upserting stock for simple product:\", stockInserts);\n                    for (const s of stockInserts){\n                        await trx.insertInto(\"product_stock\").values(s).onConflict((oc)=>oc.columns([\n                                \"variantId\",\n                                \"countryCode\"\n                            ]).doUpdateSet({\n                                stockLevel: s.stockLevel,\n                                visibility: s.visibility,\n                                manageStock: s.manageStock,\n                                allowBackorder: s.allowBackorder\n                            })).execute();\n                    }\n                }\n            }\n            return insertedProduct;\n        });\n        console.log(\"[POST] Transaction complete. Inserted product:\", product);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(product, {\n            status: 201\n        });\n    } catch (error) {\n        console.error(\"[POST] Error:\", error.message, error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: error.message\n        }, {\n            status: error.message === \"Unauthorized\" ? 401 : 400\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RSxnQkFBZ0I5RCxFQUFFOEQsY0FBYzs0QkFDbEMsSUFFRDVHLE9BQU87b0JBQ1o7Z0JBQ0Y7WUFDRjtZQUVBLE9BQU9zRjtRQUNUO1FBRUEvRixRQUFRbUYsR0FBRyxDQUFDLGtEQUFrRHJDO1FBQzlELE9BQU90RSxxREFBWUEsQ0FBQzBCLElBQUksQ0FBQzRDLFNBQVM7WUFBRTNDLFFBQVE7UUFBSTtJQUNsRCxFQUFFLE9BQU9KLE9BQVk7UUFDbkJDLFFBQVFELEtBQUssQ0FBQyxpQkFBaUJBLE1BQU1FLE9BQU8sRUFBRUY7UUFDOUMsT0FBT3ZCLHFEQUFZQSxDQUFDMEIsSUFBSSxDQUN0QjtZQUFFSCxPQUFPQSxNQUFNRSxPQUFPO1FBQUMsR0FDdkI7WUFBRUUsUUFBUUosTUFBTUUsT0FBTyxLQUFLLGlCQUFpQixNQUFNO1FBQUk7SUFFM0Q7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3RyYXBpZ3JhbS8uL2FwcC9hcGkvcHJvZHVjdHMvcm91dGUudHM/OTJhOCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xuaW1wb3J0IHsgYXV0aCB9IGZyb20gJ0AvdXRpbHMvYXV0aCc7XG5pbXBvcnQgeyBkYiB9IGZyb20gJ0AvdXRpbHMvZGInO1xuXG4vKiogSGVscGVyIHRvIGdldCBvcmdhbml6YXRpb24gSUQgZnJvbSBzZXNzaW9uICovXG5hc3luYyBmdW5jdGlvbiBnZXRPcmdJZE9yVGhyb3cocmVxOiBOZXh0UmVxdWVzdCkge1xuICBjb25zdCBzZXNzaW9uUmVzcG9uc2UgPSBhd2FpdCBhdXRoLmFwaS5nZXRTZXNzaW9uKHsgaGVhZGVyczogcmVxLmhlYWRlcnMgfSk7XG4gIGlmICghc2Vzc2lvblJlc3BvbnNlIHx8ICFzZXNzaW9uUmVzcG9uc2Uuc2Vzc2lvbikge1xuICAgIHRocm93IG5ldyBFcnJvcignVW5hdXRob3JpemVkJyk7XG4gIH1cbiAgY29uc3QgYWN0aXZlT3JnSWQgPSBzZXNzaW9uUmVzcG9uc2Uuc2Vzc2lvbi5hY3RpdmVPcmdhbml6YXRpb25JZDtcbiAgaWYgKCFhY3RpdmVPcmdJZCkgdGhyb3cgbmV3IEVycm9yKCdObyBhY3RpdmUgb3JnYW5pemF0aW9uIGluIHNlc3Npb24nKTtcbiAgcmV0dXJuIGFjdGl2ZU9yZ0lkO1xufVxuXG4vKipcbiAqIEdFVCAvYXBpL3Byb2R1Y3RzXG4gKlxuICogQmVoYXZpb3I6XG4gKiAgLSBJZiBubyBxdWVyeSBwYXJhbXM6IHJldHVybnMgYWxsIHBhcmVudCBwcm9kdWN0cyAoc2ltcGxlIG9yIHZhcmlhYmxlKSB3aXRoOlxuICogICAgICBpZCwgbmFtZSwgc2t1LCB0eXBlLCBpbWFnZVVSTCwgY2F0ZWdvcmllc1tdLCBwbHVzIGFuIFwiYWdncmVnYXRlZFN0b2NrXCIgc3VtbWFyeVxuICogICAgICAodG90YWxTdG9jayksIGFuZCBmb3IgdmFyaWFibGUgcHJvZHVjdHM6IHZhcmlhYmxlTWluUHJpY2UgJiB2YXJpYWJsZU1heFByaWNlXG4gKlxuICogIC0gSWYgcXVlcnkgcGFyYW0gP2lkPXh4eCBvciA/c2t1PXh4eDogcmV0dXJucyBkZXRhaWxzIGZvciB0aGF0IHNpbmdsZSBwcm9kdWN0LFxuICogICAgICBpbmNsdWRpbmc6XG4gKiAgICAgICAgLSBwcm9kdWN0LWxldmVsIGZpZWxkc1xuICogICAgICAgIC0gY2F0ZWdvcmllc1xuICogICAgICAgIC0gYW4gYXJyYXkgb2YgYWxsIHZhcmlhbnRzIChmb3IgdmFyaWFibGUpLCBlYWNoIHdpdGggc3RvY2sgbGluZXNcbiAqICAgICAgICAtIG9yIHRoZSBzaW5nbGUgdmFyaWFudCArIHN0b2NrIGxpbmVzIChmb3Igc2ltcGxlKVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKHJlcTogTmV4dFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBvcmdhbml6YXRpb25JZCA9IGF3YWl0IGdldE9yZ0lkT3JUaHJvdyhyZXEpO1xuXG4gICAgLy8gRXh0cmFjdCBzZWFyY2ggcGFyYW1zOiA/aWQ9eHh4IG9yID9za3U9eHh4XG4gICAgY29uc3QgeyBzZWFyY2hQYXJhbXMgfSA9IG5ldyBVUkwocmVxLnVybCk7XG4gICAgY29uc3QgcGFyYW1JZCA9IHNlYXJjaFBhcmFtcy5nZXQoJ2lkJyk7XG4gICAgY29uc3QgcGFyYW1Ta3UgPSBzZWFyY2hQYXJhbXMuZ2V0KCdza3UnKTtcblxuICAgIC8vIElmIHVzZXIgcHJvdmlkZWQgP2lkIG9yID9za3UsIHdlIGRvIFwiZ2V0T25lUHJvZHVjdERldGFpbFwiXG4gICAgaWYgKHBhcmFtSWQgfHwgcGFyYW1Ta3UpIHtcbiAgICAgIHJldHVybiBhd2FpdCBnZXRPbmVQcm9kdWN0RGV0YWlsKG9yZ2FuaXphdGlvbklkLCBwYXJhbUlkLCBwYXJhbVNrdSk7XG4gICAgfVxuXG4gICAgLy8gT3RoZXJ3aXNlLCB3ZSByZXR1cm4gdGhlIGVudGlyZSBsaXN0IG9mIHBhcmVudCBwcm9kdWN0cyB3aXRoIHBhcnRpYWwgZGV0YWlsc1xuICAgIHJldHVybiBhd2FpdCBnZXRBbGxQYXJlbnRQcm9kdWN0cyhvcmdhbml6YXRpb25JZCk7XG5cbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1tHRVRdIC9hcGkvcHJvZHVjdHMgRXJyb3I6JywgZXJyb3IubWVzc2FnZSk7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LFxuICAgICAgeyBzdGF0dXM6IGVycm9yLm1lc3NhZ2UgPT09ICdVbmF1dGhvcml6ZWQnID8gNDAxIDogNDAwIH0sXG4gICAgKTtcbiAgfVxufVxuXG4vKiogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAqICBnZXRBbGxQYXJlbnRQcm9kdWN0cyhvcmdhbml6YXRpb25JZClcbiAqICAgIFJldHVybnMgYW4gYXJyYXkgb2YgcHJvZHVjdHMgd2l0aDpcbiAqICAgICAgLSBwcm9kdWN0IGZpZWxkczogaWQsIG5hbWUsIHR5cGUsIHNrdSwgaW1hZ2VVUkwsIC4uLlxuICogICAgICAtIGNhdGVnb3JpZXNbXSBhcnJheVxuICogICAgICAtIHRvdGFsU3RvY2sgKHN1bSBvZiBhbGwgdmFyaWFudCBzdG9jaylcbiAqICAgICAgLSB2YXJpYWJsZU1pblByaWNlICYgdmFyaWFibGVNYXhQcmljZSBmb3IgdmFyaWFibGUgcHJvZHVjdHNcbiAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki9cbmFzeW5jIGZ1bmN0aW9uIGdldEFsbFBhcmVudFByb2R1Y3RzKG9yZ2FuaXphdGlvbklkOiBzdHJpbmcpIHtcbiAgLy8gMSkgRmV0Y2ggdGhlIHBhcmVudCBwcm9kdWN0c1xuICBjb25zdCBwcm9kdWN0cyA9IGF3YWl0IGRiXG4gICAgLnNlbGVjdEZyb20oJ3Byb2R1Y3QgYXMgcCcpXG4gICAgLnNlbGVjdChbXG4gICAgICAncC5pZCcsXG4gICAgICAncC5uYW1lJyxcbiAgICAgICdwLnR5cGUnLFxuICAgICAgJ3Auc2t1JyxcbiAgICAgICdwLnByaWNlJyxcbiAgICAgICdwLnN0YXR1cycsXG4gICAgICAncC5pbWFnZVVSTCcsXG4gICAgICAncC5jcmVhdGVkQXQnLFxuICAgICAgJ3AudXBkYXRlZEF0JyxcbiAgICBdKVxuICAgIC53aGVyZSgncC5vcmdhbml6YXRpb25JZCcsICc9Jywgb3JnYW5pemF0aW9uSWQpXG4gICAgLm9yZGVyQnkoJ3AuY3JlYXRlZEF0JywgJ2Rlc2MnKVxuICAgIC5leGVjdXRlKCk7XG5cbiAgY29uc3QgcHJvZHVjdElkcyA9IHByb2R1Y3RzLm1hcCgocCkgPT4gcC5pZCk7XG5cbiAgLy8gMikgRmV0Y2ggYWxsIGNhdGVnb3J5IGFzc2lnbm1lbnRzIGluIGJ1bGtcbiAgLy8gICAgV2UgdGhlbiBncm91cCBieSBwcm9kdWN0SWRcbiAgY29uc3QgY2F0ZWdvcnlBc3NpZ25tZW50cyA9IGF3YWl0IGRiXG4gICAgLnNlbGVjdEZyb20oJ3Byb2R1Y3RfY2F0ZWdvcnlfYXNzaWdubWVudHMgYXMgcGNhJylcbiAgICAuaW5uZXJKb2luKCdwcm9kdWN0X2NhdGVnb3JpZXMgYXMgYycsICdjLmlkJywgJ3BjYS5jYXRlZ29yeUlkJylcbiAgICAuc2VsZWN0KFtcbiAgICAgICdwY2EucHJvZHVjdElkJyxcbiAgICAgICdjLmlkIGFzIGNhdGVnb3J5SWQnLFxuICAgICAgJ2MubmFtZSBhcyBjYXRlZ29yeU5hbWUnLFxuICAgICAgJ2MucGFyZW50SWQgYXMgY2F0ZWdvcnlQYXJlbnQnLFxuICAgIF0pXG4gICAgLndoZXJlKCdwY2Eub3JnYW5pemF0aW9uSWQnLCAnPScsIG9yZ2FuaXphdGlvbklkKVxuICAgIC53aGVyZSgncGNhLnByb2R1Y3RJZCcsICdpbicsIHByb2R1Y3RJZHMpXG4gICAgLmV4ZWN1dGUoKTtcblxuICBjb25zdCBjYXRlZ29yaWVzQnlQcm9kdWN0SWQ6IFJlY29yZDxzdHJpbmcsIHsgY2F0ZWdvcnlJZDogc3RyaW5nOyBjYXRlZ29yeU5hbWU6IHN0cmluZzsgY2F0ZWdvcnlQYXJlbnQ6IHN0cmluZyB8IG51bGwgfVtdPiA9IHt9O1xuICBmb3IgKGNvbnN0IGNhIG9mIGNhdGVnb3J5QXNzaWdubWVudHMpIHtcbiAgICBpZiAoIWNhdGVnb3JpZXNCeVByb2R1Y3RJZFtjYS5wcm9kdWN0SWRdKSB7XG4gICAgICBjYXRlZ29yaWVzQnlQcm9kdWN0SWRbY2EucHJvZHVjdElkXSA9IFtdO1xuICAgIH1cbiAgICBjYXRlZ29yaWVzQnlQcm9kdWN0SWRbY2EucHJvZHVjdElkXS5wdXNoKHtcbiAgICAgIGNhdGVnb3J5SWQ6IGNhLmNhdGVnb3J5SWQsXG4gICAgICBjYXRlZ29yeU5hbWU6IGNhLmNhdGVnb3J5TmFtZSxcbiAgICAgIGNhdGVnb3J5UGFyZW50OiBjYS5jYXRlZ29yeVBhcmVudCxcbiAgICB9KTtcbiAgfVxuXG4gIC8vIDMpIEZvciBlYWNoIHByb2R1Y3QsIHdlIHdhbnQgYW4gYWdncmVnYXRlZCBzdG9jayBhcHByb2FjaFxuICAvLyAgICBXZSdsbCBmZXRjaCBmcm9tIHByb2R1Y3RfdmFyaWFudHMgPT4gcHJvZHVjdF9zdG9ja1xuICAvLyAgICBTdW1taW5nIGFsbCBzdG9jayBpZiBpdCdzIHZhcmlhYmxlLCBvciBqdXN0IHRoZSBzaW5nbGUgdmFyaWFudCBpZiBzaW1wbGVcbiAgLy8gICAgVGhlbiBncm91cCBieSBwcm9kdWN0SWRcbiAgY29uc3QgdmFyaWFudFJvd3MgPSBhd2FpdCBkYlxuICAgIC5zZWxlY3RGcm9tKCdwcm9kdWN0X3ZhcmlhbnRzIGFzIHB2JylcbiAgICAubGVmdEpvaW4oJ3Byb2R1Y3Rfc3RvY2sgYXMgcHMnLCAncHMudmFyaWFudElkJywgJ3B2LmlkJylcbiAgICAuc2VsZWN0KFtcbiAgICAgICdwdi5wcm9kdWN0SWQnLFxuICAgICAgJ3B2LmlkIGFzIHZhcmlhbnRJZCcsXG4gICAgICAncHYuc2t1IGFzIHZhcmlhbnRTa3UnLFxuICAgICAgJ3B2LnByaWNlIGFzIHZhcmlhbnRQcmljZScsXG4gICAgICAncHMuc3RvY2tMZXZlbCcsXG4gICAgICAncHMudmlzaWJpbGl0eScsXG4gICAgICAncHMubWFuYWdlU3RvY2snLFxuICAgICAgJ3BzLmFsbG93QmFja29yZGVyJyxcbiAgICBdKVxuICAgIC53aGVyZSgncHYub3JnYW5pemF0aW9uSWQnLCAnPScsIG9yZ2FuaXphdGlvbklkKVxuICAgIC53aGVyZSgncHYucHJvZHVjdElkJywgJ2luJywgcHJvZHVjdElkcylcbiAgICAuZXhlY3V0ZSgpO1xuXG4gIC8vIFdlJ2xsIGFjY3VtdWxhdGUgdG90YWxTdG9jayBwZXIgcHJvZHVjdCwgYW5kIGFsc28gdHJhY2tcbiAgLy8gbWluL21heCB2YXJpYW50IHByaWNlIGZvciB2YXJpYWJsZSBwcm9kdWN0c1xuICBjb25zdCBhZ2dyZWdhdGVkU3RvY2tCeVByb2R1Y3RJZDogUmVjb3JkPHN0cmluZywgbnVtYmVyPiA9IHt9O1xuICAvLyBtaW5QcmljZSAvIG1heFByaWNlIGZvciB2YXJpYWJsZVxuICBjb25zdCBtaW5QcmljZUJ5UHJvZHVjdElkOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+ID0ge307XG4gIGNvbnN0IG1heFByaWNlQnlQcm9kdWN0SWQ6IFJlY29yZDxzdHJpbmcsIG51bWJlcj4gPSB7fTtcblxuICBmb3IgKGNvbnN0IHZyIG9mIHZhcmlhbnRSb3dzKSB7XG4gICAgY29uc3QgcGlkID0gdnIucHJvZHVjdElkO1xuICAgIGlmICghYWdncmVnYXRlZFN0b2NrQnlQcm9kdWN0SWRbcGlkXSkge1xuICAgICAgYWdncmVnYXRlZFN0b2NrQnlQcm9kdWN0SWRbcGlkXSA9IDA7XG4gICAgfVxuICAgIGFnZ3JlZ2F0ZWRTdG9ja0J5UHJvZHVjdElkW3BpZF0gKz0gdnIuc3RvY2tMZXZlbCB8fCAwO1xuXG4gICAgLy8gRm9yIHZhcmlhYmxlIG1pbi9tYXgsIHdlIGNoZWNrIHZhcmlhbnRQcmljZVxuICAgIC8vIFdlJ2xsIGp1c3QgYWx3YXlzIHRyYWNrIG1pbi9tYXggZm9yIGV2ZXJ5IHZhcmlhbnQsXG4gICAgLy8gdGhvdWdoIGZvciBzaW1wbGUgcHJvZHVjdHMgdGhlcmUncyBvbmx5IDEgdmFyaWFudCBhbnl3YXlcbiAgICBjb25zdCB2UHJpY2UgPSB2ci52YXJpYW50UHJpY2UgfHwgMDtcbiAgICBpZiAobWluUHJpY2VCeVByb2R1Y3RJZFtwaWRdID09PSB1bmRlZmluZWQpIHtcbiAgICAgIG1pblByaWNlQnlQcm9kdWN0SWRbcGlkXSA9IHZQcmljZTtcbiAgICAgIG1heFByaWNlQnlQcm9kdWN0SWRbcGlkXSA9IHZQcmljZTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKHZQcmljZSA8IG1pblByaWNlQnlQcm9kdWN0SWRbcGlkXSkge1xuICAgICAgICBtaW5QcmljZUJ5UHJvZHVjdElkW3BpZF0gPSB2UHJpY2U7XG4gICAgICB9XG4gICAgICBpZiAodlByaWNlID4gbWF4UHJpY2VCeVByb2R1Y3RJZFtwaWRdKSB7XG4gICAgICAgIG1heFByaWNlQnlQcm9kdWN0SWRbcGlkXSA9IHZQcmljZTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyA0KSBDb25zdHJ1Y3QgZmluYWwgYXJyYXkgb2YgcHJvZHVjdCBkYXRhXG4gIGNvbnN0IGZpbmFsID0gcHJvZHVjdHMubWFwKChwKSA9PiB7XG4gICAgY29uc3QgdG90YWxTdG9jayA9IGFnZ3JlZ2F0ZWRTdG9ja0J5UHJvZHVjdElkW3AuaWRdIHx8IDA7XG4gICAgY29uc3QgY2F0cyA9IGNhdGVnb3JpZXNCeVByb2R1Y3RJZFtwLmlkXSB8fCBbXTtcblxuICAgIC8vIElmIHRoaXMgaXMgYSB2YXJpYWJsZSBwcm9kdWN0LCB3ZSBwdXRcbiAgICAvLyAgIHZhcmlhYmxlTWluUHJpY2UsIHZhcmlhYmxlTWF4UHJpY2VcbiAgICAvLyAgIG90aGVyd2lzZSBmb3Igc2ltcGxlIHdlIGhhdmUgcC5wcmljZVxuICAgIGxldCB2YXJpYWJsZU1pblByaWNlID0gbnVsbDtcbiAgICBsZXQgdmFyaWFibGVNYXhQcmljZSA9IG51bGw7XG4gICAgaWYgKHAudHlwZSA9PT0gJ3ZhcmlhYmxlJykge1xuICAgICAgLy8gZmFsbGJhY2sgaWYgbm8gdmFyaWFudHMgPT4gMFxuICAgICAgdmFyaWFibGVNaW5QcmljZSA9IG1pblByaWNlQnlQcm9kdWN0SWRbcC5pZF0gfHwgMDtcbiAgICAgIHZhcmlhYmxlTWF4UHJpY2UgPSBtYXhQcmljZUJ5UHJvZHVjdElkW3AuaWRdIHx8IDA7XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIGlkOiBwLmlkLFxuICAgICAgbmFtZTogcC5uYW1lLFxuICAgICAgdHlwZTogcC50eXBlLFxuICAgICAgc2t1OiBwLnNrdSxcbiAgICAgIHN0YXR1czogcC5zdGF0dXMsXG4gICAgICBpbWFnZVVSTDogcC5pbWFnZVVSTCxcbiAgICAgIC8vIEZvciBzaW1wbGUgcHJvZHVjdHMsICdwcmljZScgaXMgc3RvcmVkIG9uIHAucHJpY2VcbiAgICAgIC8vIEZvciB2YXJpYWJsZSwgd2UgZG8gbWluL21heFxuICAgICAgcHJpY2U6IHAucHJpY2UsXG4gICAgICB2YXJpYWJsZU1pblByaWNlLFxuICAgICAgdmFyaWFibGVNYXhQcmljZSxcbiAgICAgIHRvdGFsU3RvY2ssXG4gICAgICBjYXRlZ29yaWVzOiBjYXRzLFxuICAgIH07XG4gIH0pO1xuXG4gIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihmaW5hbCwgeyBzdGF0dXM6IDIwMCB9KTtcbn1cblxuLyoqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gKiAgZ2V0T25lUHJvZHVjdERldGFpbChvcmdhbml6YXRpb25JZCwgaWQ/LCBza3U/KVxuICogICAgUmV0dXJucyBhIHNpbmdsZSBwcm9kdWN0ICp3aXRoIGFsbCBkZXRhaWxzKjpcbiAqICAgICAgLSBwcm9kdWN0IGZpZWxkc1xuICogICAgICAtIGNhdGVnb3JpZXNcbiAqICAgICAgLSBhbiBhcnJheSBvZiB2YXJpYW50cyAoZXZlbiBmb3Igc2ltcGxlID0+IDEgdmFyaWFudClcbiAqICAgICAgICBlYWNoIHZhcmlhbnQgaGFzIHN0b2NrIGxpbmVzXG4gKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovXG5hc3luYyBmdW5jdGlvbiBnZXRPbmVQcm9kdWN0RGV0YWlsKFxuICBvcmdhbml6YXRpb25JZDogc3RyaW5nLFxuICBwcm9kdWN0SWQ6IHN0cmluZyB8IG51bGwsXG4gIHByb2R1Y3RTa3U6IHN0cmluZyB8IG51bGwsXG4pIHtcbiAgLy8gMSkgRmluZCB0aGUgcHJvZHVjdCByb3cgYnkgSUQgb3IgU0tVXG4gIGxldCBwcm9kdWN0OiBhbnk7XG4gIGlmIChwcm9kdWN0SWQpIHtcbiAgICBwcm9kdWN0ID0gYXdhaXQgZGJcbiAgICAgIC5zZWxlY3RGcm9tKCdwcm9kdWN0JylcbiAgICAgIC5zZWxlY3RBbGwoKVxuICAgICAgLndoZXJlKCdvcmdhbml6YXRpb25JZCcsICc9Jywgb3JnYW5pemF0aW9uSWQpXG4gICAgICAud2hlcmUoJ2lkJywgJz0nLCBwcm9kdWN0SWQpXG4gICAgICAuZXhlY3V0ZVRha2VGaXJzdCgpO1xuICB9IGVsc2UgaWYgKHByb2R1Y3RTa3UpIHtcbiAgICBwcm9kdWN0ID0gYXdhaXQgZGJcbiAgICAgIC5zZWxlY3RGcm9tKCdwcm9kdWN0JylcbiAgICAgIC5zZWxlY3RBbGwoKVxuICAgICAgLndoZXJlKCdvcmdhbml6YXRpb25JZCcsICc9Jywgb3JnYW5pemF0aW9uSWQpXG4gICAgICAud2hlcmUoJ3NrdScsICc9JywgcHJvZHVjdFNrdSlcbiAgICAgIC5leGVjdXRlVGFrZUZpcnN0KCk7XG4gIH1cblxuICBpZiAoIXByb2R1Y3QpIHtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1Byb2R1Y3Qgbm90IGZvdW5kJyB9LCB7IHN0YXR1czogNDA0IH0pO1xuICB9XG5cbiAgY29uc3QgcGlkID0gcHJvZHVjdC5pZDtcblxuICAvLyAyKSBHZXQgY2F0ZWdvcmllcyBmb3IgdGhpcyBwcm9kdWN0XG4gIGNvbnN0IGNhdGVnb3JpZXMgPSBhd2FpdCBkYlxuICAgIC5zZWxlY3RGcm9tKCdwcm9kdWN0X2NhdGVnb3J5X2Fzc2lnbm1lbnRzIGFzIHBjYScpXG4gICAgLmlubmVySm9pbigncHJvZHVjdF9jYXRlZ29yaWVzIGFzIGMnLCAnYy5pZCcsICdwY2EuY2F0ZWdvcnlJZCcpXG4gICAgLnNlbGVjdChbXG4gICAgICAnYy5pZCBhcyBjYXRlZ29yeUlkJyxcbiAgICAgICdjLm5hbWUgYXMgY2F0ZWdvcnlOYW1lJyxcbiAgICAgICdjLnBhcmVudElkIGFzIGNhdGVnb3J5UGFyZW50JyxcbiAgICAgICdjLnNsdWcgYXMgY2F0ZWdvcnlTbHVnJyxcbiAgICBdKVxuICAgIC53aGVyZSgncGNhLnByb2R1Y3RJZCcsICc9JywgcGlkKVxuICAgIC53aGVyZSgncGNhLm9yZ2FuaXphdGlvbklkJywgJz0nLCBvcmdhbml6YXRpb25JZClcbiAgICAuZXhlY3V0ZSgpO1xuXG4gIC8vIDMpIEZldGNoIGFsbCB2YXJpYW50cyBmb3IgdGhpcyBwcm9kdWN0IChpbmNsdWRpbmcgc2ltcGxlID0+IDEgdmFyaWFudClcbiAgY29uc3QgdmFyaWFudHMgPSBhd2FpdCBkYlxuICAgIC5zZWxlY3RGcm9tKCdwcm9kdWN0X3ZhcmlhbnRzIGFzIHB2JylcbiAgICAuc2VsZWN0QWxsKClcbiAgICAud2hlcmUoJ3B2LnByb2R1Y3RJZCcsICc9JywgcGlkKVxuICAgIC53aGVyZSgncHYub3JnYW5pemF0aW9uSWQnLCAnPScsIG9yZ2FuaXphdGlvbklkKVxuICAgIC5leGVjdXRlKCk7XG5cbiAgLy8gNCkgRm9yIGVhY2ggdmFyaWFudCwgZmV0Y2ggc3RvY2sgbGluZXNcbiAgY29uc3QgdmFyaWFudElkcyA9IHZhcmlhbnRzLm1hcCgodikgPT4gdi5pZCk7XG4gIGxldCBhbGxTdG9jayA9IFtdIGFzIGFueVtdO1xuICBpZiAodmFyaWFudElkcy5sZW5ndGggPiAwKSB7XG4gICAgYWxsU3RvY2sgPSBhd2FpdCBkYlxuICAgICAgLnNlbGVjdEZyb20oJ3Byb2R1Y3Rfc3RvY2sgYXMgcHMnKVxuICAgICAgLnNlbGVjdEFsbCgpXG4gICAgICAud2hlcmUoJ3BzLnZhcmlhbnRJZCcsICdpbicsIHZhcmlhbnRJZHMpXG4gICAgICAud2hlcmUoJ3BzLm9yZ2FuaXphdGlvbklkJywgJz0nLCBvcmdhbml6YXRpb25JZClcbiAgICAgIC5leGVjdXRlKCk7XG4gIH1cblxuICAvLyBHcm91cCBzdG9jayBieSB2YXJpYW50SWRcbiAgY29uc3Qgc3RvY2tCeVZhcmlhbnRJZDogUmVjb3JkPHN0cmluZywgYW55W10+ID0ge307XG4gIGZvciAoY29uc3QgcyBvZiBhbGxTdG9jaykge1xuICAgIGlmICghc3RvY2tCeVZhcmlhbnRJZFtzLnZhcmlhbnRJZF0pIHtcbiAgICAgIHN0b2NrQnlWYXJpYW50SWRbcy52YXJpYW50SWRdID0gW107XG4gICAgfVxuICAgIHN0b2NrQnlWYXJpYW50SWRbcy52YXJpYW50SWRdLnB1c2gocyk7XG4gIH1cblxuICAvLyA1KSBDb21iaW5lIHZhcmlhbnQgKyBzdG9ja1xuICAvLyAgICBBbHNvIGZldGNoIHZhcmlhbnQgdGVybXMgaWYgeW91IHdhbnQgZnVsbHkgZGV0YWlsZWQgYXR0cmlidXRlL3Rlcm0gdXNhZ2VcbiAgY29uc3QgdmFyaWFudFRlcm1zUm93cyA9IGF3YWl0IGRiXG4gICAgLnNlbGVjdEZyb20oJ3Byb2R1Y3RfdmFyaWFudF90ZXJtcyBhcyBwdnQnKVxuICAgIC5pbm5lckpvaW4oJ3Byb2R1Y3RfYXR0cmlidXRlX3Rlcm1zIGFzIHBhdCcsICdwYXQuaWQnLCAncHZ0LnRlcm1JZCcpXG4gICAgLnNlbGVjdChbXG4gICAgICAncHZ0LnZhcmlhbnRJZCcsXG4gICAgICAncGF0LmF0dHJpYnV0ZUlkJyxcbiAgICAgICdwYXQubmFtZSBhcyB0ZXJtTmFtZScsXG4gICAgICAncGF0LnNsdWcgYXMgdGVybVNsdWcnLFxuICAgIF0pXG4gICAgLndoZXJlKCdwdnQudmFyaWFudElkJywgJ2luJywgdmFyaWFudElkcylcbiAgICAud2hlcmUoJ3B2dC5vcmdhbml6YXRpb25JZCcsICc9Jywgb3JnYW5pemF0aW9uSWQpXG4gICAgLmV4ZWN1dGUoKTtcblxuICBjb25zdCB0ZXJtc0J5VmFyaWFudElkOiBSZWNvcmQ8c3RyaW5nLCBhbnlbXT4gPSB7fTtcbiAgZm9yIChjb25zdCB2dCBvZiB2YXJpYW50VGVybXNSb3dzKSB7XG4gICAgaWYgKCF0ZXJtc0J5VmFyaWFudElkW3Z0LnZhcmlhbnRJZF0pIHtcbiAgICAgIHRlcm1zQnlWYXJpYW50SWRbdnQudmFyaWFudElkXSA9IFtdO1xuICAgIH1cbiAgICB0ZXJtc0J5VmFyaWFudElkW3Z0LnZhcmlhbnRJZF0ucHVzaCh7XG4gICAgICBhdHRyaWJ1dGVJZDogdnQuYXR0cmlidXRlSWQsXG4gICAgICBuYW1lOiB2dC50ZXJtTmFtZSxcbiAgICAgIHNsdWc6IHZ0LnRlcm1TbHVnLFxuICAgIH0pO1xuICB9XG5cbiAgY29uc3QgdmFyaWFudHNXaXRoU3RvY2sgPSB2YXJpYW50cy5tYXAoKHYpID0+ICh7XG4gICAgLi4udixcbiAgICBzdG9jazogc3RvY2tCeVZhcmlhbnRJZFt2LmlkXSB8fCBbXSxcbiAgICB0ZXJtczogdGVybXNCeVZhcmlhbnRJZFt2LmlkXSB8fCBbXSxcbiAgfSkpO1xuXG4gIC8vIDYpIE9wdGlvbmFsbHkgZmV0Y2ggXCJhdHRyaWJ1dGUgYXNzaWdubWVudHNcIiBmb3IgdGhlIHBhcmVudCBwcm9kdWN0XG4gIGNvbnN0IGF0dHJpYnV0ZUFzc2lnbm1lbnRzID0gYXdhaXQgZGJcbiAgICAuc2VsZWN0RnJvbSgncHJvZHVjdF9hdHRyaWJ1dGVfYXNzaWdubWVudHMgYXMgcGFhJylcbiAgICAuaW5uZXJKb2luKCdwcm9kdWN0X2F0dHJpYnV0ZXMgYXMgcGEnLCAncGEuaWQnLCAncGFhLmF0dHJpYnV0ZUlkJylcbiAgICAubGVmdEpvaW4oJ3Byb2R1Y3RfdGVybSBhcyBwdCcsIChqb2luKSA9PiB7XG4gICAgICBqb2luXG4gICAgICAgIC5vblJlZigncHQucHJvZHVjdElkJywgJz0nLCAncGFhLnByb2R1Y3RJZCcpXG4gICAgICAgIC5vblJlZigncHQuYXR0cmlidXRlSWQnLCAnPScsICdwYWEuYXR0cmlidXRlSWQnKTtcbiAgICB9KVxuICAgIC5sZWZ0Sm9pbigncHJvZHVjdF9hdHRyaWJ1dGVfdGVybXMgYXMgcGF0MicsICdwYXQyLmlkJywgJ3B0LnRlcm1JZCcpXG4gICAgLnNlbGVjdChbXG4gICAgICAncGFhLmF0dHJpYnV0ZUlkJyxcbiAgICAgICdwYWEudXNlZEZvclZhcmlhdGlvbicsXG4gICAgICAncGEubmFtZSBhcyBhdHRyaWJ1dGVOYW1lJyxcbiAgICAgICdwYS5zbHVnIGFzIGF0dHJpYnV0ZVNsdWcnLFxuICAgICAgJ3BhdDIuaWQgYXMgdGVybUlkJyxcbiAgICAgICdwYXQyLm5hbWUgYXMgdGVybU5hbWUnLFxuICAgICAgJ3BhdDIuc2x1ZyBhcyB0ZXJtU2x1ZycsXG4gICAgXSlcbiAgICAud2hlcmUoJ3BhYS5wcm9kdWN0SWQnLCAnPScsIHBpZClcbiAgICAud2hlcmUoJ3BhYS5vcmdhbml6YXRpb25JZCcsICc9Jywgb3JnYW5pemF0aW9uSWQpXG4gICAgLmV4ZWN1dGUoKTtcblxuICBjb25zdCBhdHRyc0J5SWQ6IFJlY29yZDxzdHJpbmcsIHtcbiAgICBhdHRyaWJ1dGVJZDogc3RyaW5nO1xuICAgIHVzZWRGb3JWYXJpYXRpb246IGJvb2xlYW47XG4gICAgYXR0cmlidXRlTmFtZTogc3RyaW5nO1xuICAgIGF0dHJpYnV0ZVNsdWc6IHN0cmluZztcbiAgICB0ZXJtczogeyBpZDogc3RyaW5nOyBuYW1lOiBzdHJpbmc7IHNsdWc6IHN0cmluZyB9W107XG4gIH0+ID0ge307XG4gIGZvciAoY29uc3Qgcm93IG9mIGF0dHJpYnV0ZUFzc2lnbm1lbnRzKSB7XG4gICAgY29uc3QgYUlkID0gcm93LmF0dHJpYnV0ZUlkO1xuICAgIGlmICghYXR0cnNCeUlkW2FJZF0pIHtcbiAgICAgIGF0dHJzQnlJZFthSWRdID0ge1xuICAgICAgICBhdHRyaWJ1dGVJZDogYUlkLFxuICAgICAgICB1c2VkRm9yVmFyaWF0aW9uOiAhIXJvdy51c2VkRm9yVmFyaWF0aW9uLFxuICAgICAgICBhdHRyaWJ1dGVOYW1lOiByb3cuYXR0cmlidXRlTmFtZSEsXG4gICAgICAgIGF0dHJpYnV0ZVNsdWc6IHJvdy5hdHRyaWJ1dGVTbHVnISxcbiAgICAgICAgdGVybXM6IFtdLFxuICAgICAgfTtcbiAgICB9XG4gICAgaWYgKHJvdy50ZXJtSWQpIHtcbiAgICAgIGF0dHJzQnlJZFthSWRdLnRlcm1zLnB1c2goe1xuICAgICAgICBpZDogcm93LnRlcm1JZCxcbiAgICAgICAgbmFtZTogcm93LnRlcm1OYW1lISxcbiAgICAgICAgc2x1Zzogcm93LnRlcm1TbHVnISxcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuICBjb25zdCBwcm9kdWN0QXR0cmlidXRlcyA9IE9iamVjdC52YWx1ZXMoYXR0cnNCeUlkKTtcblxuICAvLyA3KSBCdWlsZCBmaW5hbCBzaW5nbGUtcHJvZHVjdCByZXNwb25zZVxuICBjb25zdCBmdWxsUHJvZHVjdCA9IHtcbiAgICAuLi5wcm9kdWN0LFxuICAgIGNhdGVnb3JpZXMsXG4gICAgYXR0cmlidXRlczogcHJvZHVjdEF0dHJpYnV0ZXMsXG4gICAgdmFyaWFudHM6IHZhcmlhbnRzV2l0aFN0b2NrLFxuICB9O1xuXG4gIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihmdWxsUHJvZHVjdCwgeyBzdGF0dXM6IDIwMCB9KTtcbn1cblxuXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcTogTmV4dFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICAvLyBHZXQgb3JnYW5pemF0aW9uIElEIGZyb20gc2Vzc2lvblxuICAgIGNvbnN0IG9yZ2FuaXphdGlvbklkID0gYXdhaXQgZ2V0T3JnSWRPclRocm93KHJlcSk7XG4gICAgY29uc29sZS5sb2coJ1tQT1NUXSBvcmdhbml6YXRpb25JZDonLCBvcmdhbml6YXRpb25JZCk7XG5cbiAgICAvLyBQYXJzZSBpbmNvbWluZyBwYXlsb2FkXG4gICAgY29uc3Qge1xuICAgICAgbmFtZSxcbiAgICAgIGRlc2NyaXB0aW9uLFxuICAgICAgdHlwZSwgLy8gXCJzaW1wbGVcIiBvciBcInZhcmlhYmxlXCJcbiAgICAgIHNrdSxcbiAgICAgIHByaWNlLFxuICAgICAgc3RhdHVzLFxuICAgICAgY2F0ZWdvcmllcyxcbiAgICAgIGF0dHJpYnV0ZXMsXG4gICAgICB2YXJpYXRpb25zLCAvLyBhcnJheSBvZiB2YXJpYXRpb24gb2JqZWN0cyBpZiB2YXJpYWJsZVxuICAgICAgc3RvY2ssICAgICAgLy8gYXJyYXkgb2YgY291bnRyeS1sZXZlbCBzdG9jayBpZiBzaW1wbGVcbiAgICAgIGltYWdlVVJMLCAgIC8vIDwtLSBuZXcgcGFyZW50IHByb2R1Y3QgaW1hZ2VcbiAgICB9ID0gYXdhaXQgcmVxLmpzb24oKTtcbiAgICBjb25zb2xlLmxvZygnW1BPU1RdIFJlY2VpdmVkIHBheWxvYWQ6Jywge1xuICAgICAgbmFtZSwgZGVzY3JpcHRpb24sIHR5cGUsIHNrdSwgcHJpY2UsIHN0YXR1cyxcbiAgICAgIGNhdGVnb3JpZXMsIGF0dHJpYnV0ZXMsIHZhcmlhdGlvbnMsIHN0b2NrLCBpbWFnZVVSTFxuICAgIH0pO1xuXG4gICAgaWYgKCFuYW1lIHx8ICF0eXBlIHx8ICFzdGF0dXMpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBlcnJvcjogJ05hbWUsIHR5cGUsIGFuZCBzdGF0dXMgYXJlIHJlcXVpcmVkJyB9LFxuICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgY29uc3QgaWQgPSBjcnlwdG8ucmFuZG9tVVVJRCgpO1xuICAgIGNvbnN0IGNyZWF0ZWRBdCA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcbiAgICBjb25zdCB1cGRhdGVkQXQgPSBjcmVhdGVkQXQ7XG4gICAgY29uc29sZS5sb2coJ1tQT1NUXSBOZXcgcHJvZHVjdCBJRDonLCBpZCk7XG5cbiAgICAvLyBTdGFydCB0cmFuc2FjdGlvblxuICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCBkYi50cmFuc2FjdGlvbigpLmV4ZWN1dGUoYXN5bmMgKHRyeCkgPT4ge1xuICAgICAgLy8gMSkgSW5zZXJ0IHByb2R1Y3RcbiAgICAgIGNvbnN0IHByb2R1Y3RWYWx1ZXMgPSB7XG4gICAgICAgIGlkLFxuICAgICAgICBvcmdhbml6YXRpb25JZCxcbiAgICAgICAgbmFtZSxcbiAgICAgICAgZGVzY3JpcHRpb24sXG4gICAgICAgIHR5cGUsXG4gICAgICAgIC8vIFdlIHN0b3JlIHBhcmVudCBTS1Ugb25seSBpZiBzaW1wbGUsXG4gICAgICAgIC8vIGJ1dCB5b3UgcHJldmlvdXNseSBjaGFuZ2VkIHRvIGFsbG93IFNLVSBmb3IgYW55IHByb2R1Y3QuIElmIHNvLCByZW1vdmUgdGhlIGNvbmRpdGlvbmFsIGJlbG93OlxuICAgICAgICBza3U6IHR5cGUgPT09ICdzaW1wbGUnID8gc2t1IDogc2t1LCAvLyBvciBqdXN0ICdza3UnXG4gICAgICAgIHByaWNlOiB0eXBlID09PSAnc2ltcGxlJyA/IHByaWNlIDogbnVsbCxcbiAgICAgICAgc3RhdHVzLFxuICAgICAgICBjcmVhdGVkQXQsXG4gICAgICAgIHVwZGF0ZWRBdCxcbiAgICAgICAgaW1hZ2VVUkw6IGltYWdlVVJMIHx8IG51bGwsIC8vIHN0b3JlIHRoZSBwYXJlbnQncyBpbWFnZSAoc2ltcGxlIG9yIHZhcmlhYmxlKVxuICAgICAgfTtcbiAgICAgIGNvbnNvbGUubG9nKCdbUE9TVF0gSW5zZXJ0aW5nIHByb2R1Y3Qgd2l0aCB2YWx1ZXM6JywgcHJvZHVjdFZhbHVlcyk7XG4gICAgICBjb25zdCBpbnNlcnRlZFByb2R1Y3QgPSBhd2FpdCB0cnhcbiAgICAgICAgLmluc2VydEludG8oJ3Byb2R1Y3QnKVxuICAgICAgICAudmFsdWVzKHByb2R1Y3RWYWx1ZXMpXG4gICAgICAgIC5yZXR1cm5pbmdBbGwoKVxuICAgICAgICAuZXhlY3V0ZVRha2VGaXJzdE9yVGhyb3coKTtcbiAgICAgIGNvbnNvbGUubG9nKCdbUE9TVF0gSW5zZXJ0ZWQgcHJvZHVjdDonLCBpbnNlcnRlZFByb2R1Y3QpO1xuXG4gICAgICAvLyAyKSBJbnNlcnQgY2F0ZWdvcnkgYXNzaWdubWVudHNcbiAgICAgIGlmIChjYXRlZ29yaWVzICYmIGNhdGVnb3JpZXMubGVuZ3RoID4gMCkge1xuICAgICAgICBjb25zdCBjYXRlZ29yeUFzc2lnbm1lbnRzID0gY2F0ZWdvcmllcy5tYXAoKGNhdGVnb3J5SWQ6IHN0cmluZykgPT4gKHtcbiAgICAgICAgICBpZDogY3J5cHRvLnJhbmRvbVVVSUQoKSxcbiAgICAgICAgICBwcm9kdWN0SWQ6IGlkLFxuICAgICAgICAgIGNhdGVnb3J5SWQsXG4gICAgICAgICAgb3JnYW5pemF0aW9uSWQsXG4gICAgICAgIH0pKTtcbiAgICAgICAgY29uc29sZS5sb2coJ1tQT1NUXSBJbnNlcnRpbmcgY2F0ZWdvcnkgYXNzaWdubWVudHM6JywgY2F0ZWdvcnlBc3NpZ25tZW50cyk7XG4gICAgICAgIGF3YWl0IHRyeC5pbnNlcnRJbnRvKCdwcm9kdWN0X2NhdGVnb3J5X2Fzc2lnbm1lbnRzJylcbiAgICAgICAgICAudmFsdWVzKGNhdGVnb3J5QXNzaWdubWVudHMpXG4gICAgICAgICAgLmV4ZWN1dGUoKTtcbiAgICAgIH1cblxuICAgICAgLy8gMykgSW5zZXJ0IGF0dHJpYnV0ZSBhc3NpZ25tZW50cyBhbmQgcHJvZHVjdCB0ZXJtcyBmb3Igbm9uLXZhcmlhdGlvbiBhdHRyaWJ1dGVzXG4gICAgICBpZiAoYXR0cmlidXRlcyAmJiBhdHRyaWJ1dGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgLy8gTG9nIGEgbG9va3VwIGZvciBlYWNoIGF0dHJpYnV0ZSB0byBjb25maXJtIGV4aXN0ZW5jZSBhbmQgb3JnYW5pemF0aW9uXG4gICAgICAgIGZvciAoY29uc3QgYXR0ciBvZiBhdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgY29uc3QgZGJBdHRyID0gYXdhaXQgdHJ4LnNlbGVjdEZyb20oJ3Byb2R1Y3RfYXR0cmlidXRlcycpXG4gICAgICAgICAgICAuc2VsZWN0QWxsKClcbiAgICAgICAgICAgIC53aGVyZSgnaWQnLCAnPScsIGF0dHIuYXR0cmlidXRlSWQpXG4gICAgICAgICAgICAuZXhlY3V0ZVRha2VGaXJzdCgpO1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdbUE9TVF0gTG9va3VwIGF0dHJpYnV0ZTonLCBhdHRyLmF0dHJpYnV0ZUlkLCBkYkF0dHIpO1xuICAgICAgICAgIGlmICghZGJBdHRyKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEF0dHJpYnV0ZSAke2F0dHIuYXR0cmlidXRlSWR9IG5vdCBmb3VuZCBpbiBwcm9kdWN0X2F0dHJpYnV0ZXNgKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLy8gT3B0aW9uYWw6IENoZWNrIGlmIGRiQXR0ci5vcmdhbml6YXRpb25JZCBtYXRjaGVzIG9yZ2FuaXphdGlvbklkXG4gICAgICAgICAgaWYgKGRiQXR0ci5vcmdhbml6YXRpb25JZCAhPT0gb3JnYW5pemF0aW9uSWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgICAgICAgYEF0dHJpYnV0ZSAke2F0dHIuYXR0cmlidXRlSWR9IG9yZ2FuaXphdGlvbiBtaXNtYXRjaC4gRXhwZWN0ZWQgJHtvcmdhbml6YXRpb25JZH0gYnV0IGdvdCAke2RiQXR0ci5vcmdhbml6YXRpb25JZH1gXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGF0dHJpYnV0ZUFzc2lnbm1lbnRzID0gYXR0cmlidXRlcy5tYXAoKGF0dHI6IGFueSkgPT4gKHtcbiAgICAgICAgICBpZDogY3J5cHRvLnJhbmRvbVVVSUQoKSxcbiAgICAgICAgICBwcm9kdWN0SWQ6IGlkLFxuICAgICAgICAgIGF0dHJpYnV0ZUlkOiBhdHRyLmF0dHJpYnV0ZUlkLFxuICAgICAgICAgIHVzZWRGb3JWYXJpYXRpb246IHR5cGUgPT09ICd2YXJpYWJsZScgJiYgYXR0ci51c2VkRm9yVmFyaWF0aW9uID8gMSA6IDAsXG4gICAgICAgICAgb3JnYW5pemF0aW9uSWQsXG4gICAgICAgIH0pKTtcbiAgICAgICAgY29uc29sZS5sb2coJ1tQT1NUXSBJbnNlcnRpbmcgYXR0cmlidXRlIGFzc2lnbm1lbnRzOicsIGF0dHJpYnV0ZUFzc2lnbm1lbnRzKTtcbiAgICAgICAgYXdhaXQgdHJ4Lmluc2VydEludG8oJ3Byb2R1Y3RfYXR0cmlidXRlX2Fzc2lnbm1lbnRzJylcbiAgICAgICAgICAudmFsdWVzKGF0dHJpYnV0ZUFzc2lnbm1lbnRzKVxuICAgICAgICAgIC5leGVjdXRlKCk7XG5cbiAgICAgICAgLy8gSW5zZXJ0IHRlcm1zIGZvciBhdHRyaWJ1dGVzIG5vdCB1c2VkIGZvciB2YXJpYXRpb24gKGlmIGFueSlcbiAgICAgICAgY29uc3QgdGVybXMgPSBhdHRyaWJ1dGVzXG4gICAgICAgICAgLmZpbHRlcigoYXR0cjogYW55KSA9PiAhYXR0ci51c2VkRm9yVmFyaWF0aW9uIHx8IHR5cGUgPT09ICdzaW1wbGUnKVxuICAgICAgICAgIC5mbGF0TWFwKChhdHRyOiBhbnkpID0+XG4gICAgICAgICAgICBhdHRyLnRlcm1zLm1hcCgodGVybUlkOiBzdHJpbmcpID0+ICh7XG4gICAgICAgICAgICAgIGlkOiBjcnlwdG8ucmFuZG9tVVVJRCgpLFxuICAgICAgICAgICAgICBwcm9kdWN0SWQ6IGlkLFxuICAgICAgICAgICAgICBhdHRyaWJ1dGVJZDogYXR0ci5hdHRyaWJ1dGVJZCxcbiAgICAgICAgICAgICAgdGVybUlkLFxuICAgICAgICAgICAgICBvcmdhbml6YXRpb25JZCxcbiAgICAgICAgICAgIH0pKVxuICAgICAgICAgICk7XG4gICAgICAgIGlmICh0ZXJtcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ1tQT1NUXSBJbnNlcnRpbmcgcHJvZHVjdCB0ZXJtczonLCB0ZXJtcyk7XG4gICAgICAgICAgYXdhaXQgdHJ4Lmluc2VydEludG8oJ3Byb2R1Y3RfdGVybScpLnZhbHVlcyh0ZXJtcykuZXhlY3V0ZSgpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIDQpIEluc2VydCB2YXJpYW50cyAoYW5kIHRoZWlyIHZhcmlhbnQgdGVybXMgYW5kIHN0b2NrKVxuICAgICAgaWYgKHR5cGUgPT09ICd2YXJpYWJsZScgJiYgdmFyaWF0aW9ucyAmJiB2YXJpYXRpb25zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgY29uc3QgdmFyaWFudEluc2VydHMgPSB2YXJpYXRpb25zLm1hcCgodmFyaWFudDogYW55KSA9PiAoe1xuICAgICAgICAgIGlkOiBjcnlwdG8ucmFuZG9tVVVJRCgpLFxuICAgICAgICAgIHByb2R1Y3RJZDogaWQsXG4gICAgICAgICAgb3JnYW5pemF0aW9uSWQsXG4gICAgICAgICAgc2t1OiB2YXJpYW50LnNrdSwgLy8gRm9yIHZhcmlhYmxlLCBlYWNoIHZhcmlhbnQgZ2V0cyBhbiBTS1VcbiAgICAgICAgICBwcmljZTogdmFyaWFudC5wcmljZSxcbiAgICAgICAgICBjcmVhdGVkQXQsXG4gICAgICAgICAgdXBkYXRlZEF0LFxuICAgICAgICAgIGltYWdlVVJMOiB2YXJpYW50LmltYWdlVVJMIHx8IG51bGwsIC8vIDwtLSBuZXcgdmFyaWFudCBpbWFnZVxuICAgICAgICB9KSk7XG4gICAgICAgIGNvbnNvbGUubG9nKCdbUE9TVF0gSW5zZXJ0aW5nIHZhcmlhbnRzOicsIHZhcmlhbnRJbnNlcnRzKTtcbiAgICAgICAgY29uc3QgaW5zZXJ0ZWRWYXJpYW50cyA9IGF3YWl0IHRyeC5pbnNlcnRJbnRvKCdwcm9kdWN0X3ZhcmlhbnRzJylcbiAgICAgICAgICAudmFsdWVzKHZhcmlhbnRJbnNlcnRzKVxuICAgICAgICAgIC5yZXR1cm5pbmcoWydpZCddKVxuICAgICAgICAgIC5leGVjdXRlKCk7XG4gICAgICAgIGNvbnNvbGUubG9nKCdbUE9TVF0gSW5zZXJ0ZWQgdmFyaWFudHM6JywgaW5zZXJ0ZWRWYXJpYW50cyk7XG5cbiAgICAgICAgLy8gSW5zZXJ0IHZhcmlhbnQgdGVybXNcbiAgICAgICAgY29uc3QgdmFyaWFudFRlcm1zID0gdmFyaWF0aW9ucy5mbGF0TWFwKCh2YXJpYW50OiBhbnksIGluZGV4OiBudW1iZXIpID0+XG4gICAgICAgICAgdmFyaWFudC50ZXJtcy5tYXAoKHRlcm06IGFueSkgPT4gKHtcbiAgICAgICAgICAgIGlkOiBjcnlwdG8ucmFuZG9tVVVJRCgpLFxuICAgICAgICAgICAgdmFyaWFudElkOiBpbnNlcnRlZFZhcmlhbnRzW2luZGV4XS5pZCxcbiAgICAgICAgICAgIGF0dHJpYnV0ZUlkOiB0ZXJtLmF0dHJpYnV0ZUlkLFxuICAgICAgICAgICAgdGVybUlkOiB0ZXJtLnRlcm1JZCxcbiAgICAgICAgICAgIG9yZ2FuaXphdGlvbklkLFxuICAgICAgICAgIH0pKVxuICAgICAgICApO1xuICAgICAgICBjb25zb2xlLmxvZygnW1BPU1RdIFByZXBhcmVkIHZhcmlhbnQgdGVybXM6JywgdmFyaWFudFRlcm1zKTtcbiAgICAgICAgaWYgKHZhcmlhbnRUZXJtcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgYXdhaXQgdHJ4Lmluc2VydEludG8oJ3Byb2R1Y3RfdmFyaWFudF90ZXJtcycpXG4gICAgICAgICAgICAudmFsdWVzKHZhcmlhbnRUZXJtcylcbiAgICAgICAgICAgIC5leGVjdXRlKCk7XG4gICAgICAgICAgY29uc29sZS5sb2coJ1tQT1NUXSBJbnNlcnRlZCB2YXJpYW50IHRlcm1zJyk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBJbnNlcnQgc3RvY2sgZm9yIGVhY2ggdmFyaWF0aW9uXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdmFyaWF0aW9ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIGNvbnN0IHZhcmlhdGlvbiA9IHZhcmlhdGlvbnNbaV07XG4gICAgICAgICAgY29uc3QgdmFyaWFudElkID0gaW5zZXJ0ZWRWYXJpYW50c1tpXS5pZDtcbiAgICAgICAgICBpZiAodmFyaWF0aW9uLnN0b2NrICYmIHZhcmlhdGlvbi5zdG9jay5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb25zdCBzdG9ja0luc2VydHMgPSB2YXJpYXRpb24uc3RvY2subWFwKChzdGs6IGFueSkgPT4gKHtcbiAgICAgICAgICAgICAgaWQ6IGNyeXB0by5yYW5kb21VVUlEKCksXG4gICAgICAgICAgICAgIHZhcmlhbnRJZCxcbiAgICAgICAgICAgICAgY291bnRyeUNvZGU6IHN0ay5jb3VudHJ5Q29kZSxcbiAgICAgICAgICAgICAgc3RvY2tMZXZlbDogc3RrLm1hbmFnZVN0b2NrID8gc3RrLnN0b2NrTGV2ZWwgfHwgMCA6IDk5OTk5OTk5OSxcbiAgICAgICAgICAgICAgdmlzaWJpbGl0eTogc3RrLnZpc2liaWxpdHkgPyAxIDogMCxcbiAgICAgICAgICAgICAgbWFuYWdlU3RvY2s6IHN0ay5tYW5hZ2VTdG9jayA/IDEgOiAwLFxuICAgICAgICAgICAgICBhbGxvd0JhY2tvcmRlcjogc3RrLmFsbG93QmFja29yZGVyID8gMSA6IDAsXG4gICAgICAgICAgICAgIG9yZ2FuaXphdGlvbklkLFxuICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coYFtQT1NUXSBJbnNlcnRpbmcvdXBzZXJ0aW5nIHN0b2NrIGZvciB2YXJpYW50ICR7dmFyaWFudElkfTpgLCBzdG9ja0luc2VydHMpO1xuICAgICAgICAgICAgZm9yIChjb25zdCBzIG9mIHN0b2NrSW5zZXJ0cykge1xuICAgICAgICAgICAgICBhd2FpdCB0cnguaW5zZXJ0SW50bygncHJvZHVjdF9zdG9jaycpXG4gICAgICAgICAgICAgICAgLnZhbHVlcyhzKVxuICAgICAgICAgICAgICAgIC5vbkNvbmZsaWN0KChvYykgPT5cbiAgICAgICAgICAgICAgICAgIG9jLmNvbHVtbnMoWyd2YXJpYW50SWQnLCAnY291bnRyeUNvZGUnXSkuZG9VcGRhdGVTZXQoe1xuICAgICAgICAgICAgICAgICAgICBzdG9ja0xldmVsOiBzLnN0b2NrTGV2ZWwsXG4gICAgICAgICAgICAgICAgICAgIHZpc2liaWxpdHk6IHMudmlzaWJpbGl0eSxcbiAgICAgICAgICAgICAgICAgICAgbWFuYWdlU3RvY2s6IHMubWFuYWdlU3RvY2ssXG4gICAgICAgICAgICAgICAgICAgIGFsbG93QmFja29yZGVyOiBzLmFsbG93QmFja29yZGVyLFxuICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgLmV4ZWN1dGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIFNJTVBMRSBQUk9EVUNUID0+IEluc2VydCBhIHNpbmdsZSB2YXJpYW50XG4gICAgICAgIGNvbnN0IHZhcmlhbnRJZCA9IGNyeXB0by5yYW5kb21VVUlEKCk7XG4gICAgICAgIGNvbnN0IHNpbXBsZVZhcmlhbnQgPSB7XG4gICAgICAgICAgaWQ6IHZhcmlhbnRJZCxcbiAgICAgICAgICBwcm9kdWN0SWQ6IGlkLFxuICAgICAgICAgIG9yZ2FuaXphdGlvbklkLFxuICAgICAgICAgIHNrdSxcbiAgICAgICAgICBwcmljZSxcbiAgICAgICAgICBjcmVhdGVkQXQsXG4gICAgICAgICAgdXBkYXRlZEF0LFxuICAgICAgICAgIGltYWdlVVJMOiBpbWFnZVVSTCB8fCBudWxsLCAvLyBzdG9yZSB0aGUgc2FtZSBpbWFnZSBhcyBwYXJlbnQgaWYgeW91IGxpa2VcbiAgICAgICAgfTtcbiAgICAgICAgY29uc29sZS5sb2coJ1tQT1NUXSBJbnNlcnRpbmcgc2ltcGxlIHZhcmlhbnQ6Jywgc2ltcGxlVmFyaWFudCk7XG4gICAgICAgIGF3YWl0IHRyeC5pbnNlcnRJbnRvKCdwcm9kdWN0X3ZhcmlhbnRzJylcbiAgICAgICAgICAudmFsdWVzKFtzaW1wbGVWYXJpYW50XSlcbiAgICAgICAgICAuZXhlY3V0ZSgpO1xuXG4gICAgICAgIC8vIEluc2VydCBzdG9jayBmb3Igc2ltcGxlIHByb2R1Y3RcbiAgICAgICAgaWYgKHN0b2NrICYmIHN0b2NrLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICBjb25zdCBzdG9ja0luc2VydHMgPSBzdG9jay5tYXAoKHN0azogYW55KSA9PiAoe1xuICAgICAgICAgICAgaWQ6IGNyeXB0by5yYW5kb21VVUlEKCksXG4gICAgICAgICAgICB2YXJpYW50SWQsXG4gICAgICAgICAgICBjb3VudHJ5Q29kZTogc3RrLmNvdW50cnlDb2RlLFxuICAgICAgICAgICAgc3RvY2tMZXZlbDogc3RrLm1hbmFnZVN0b2NrID8gc3RrLnN0b2NrTGV2ZWwgfHwgMCA6IDk5OTk5OTk5OSxcbiAgICAgICAgICAgIHZpc2liaWxpdHk6IHN0ay52aXNpYmlsaXR5ID8gMSA6IDAsXG4gICAgICAgICAgICBtYW5hZ2VTdG9jazogc3RrLm1hbmFnZVN0b2NrID8gMSA6IDAsXG4gICAgICAgICAgICBhbGxvd0JhY2tvcmRlcjogc3RrLmFsbG93QmFja29yZGVyID8gMSA6IDAsXG4gICAgICAgICAgICBvcmdhbml6YXRpb25JZCxcbiAgICAgICAgICB9KSk7XG4gICAgICAgICAgY29uc29sZS5sb2coJ1tQT1NUXSBJbnNlcnRpbmcvdXBzZXJ0aW5nIHN0b2NrIGZvciBzaW1wbGUgcHJvZHVjdDonLCBzdG9ja0luc2VydHMpO1xuICAgICAgICAgIGZvciAoY29uc3QgcyBvZiBzdG9ja0luc2VydHMpIHtcbiAgICAgICAgICAgIGF3YWl0IHRyeC5pbnNlcnRJbnRvKCdwcm9kdWN0X3N0b2NrJylcbiAgICAgICAgICAgICAgLnZhbHVlcyhzKVxuICAgICAgICAgICAgICAub25Db25mbGljdCgob2MpID0+XG4gICAgICAgICAgICAgICAgb2MuY29sdW1ucyhbJ3ZhcmlhbnRJZCcsICdjb3VudHJ5Q29kZSddKS5kb1VwZGF0ZVNldCh7XG4gICAgICAgICAgICAgICAgICBzdG9ja0xldmVsOiBzLnN0b2NrTGV2ZWwsXG4gICAgICAgICAgICAgICAgICB2aXNpYmlsaXR5OiBzLnZpc2liaWxpdHksXG4gICAgICAgICAgICAgICAgICBtYW5hZ2VTdG9jazogcy5tYW5hZ2VTdG9jayxcbiAgICAgICAgICAgICAgICAgIGFsbG93QmFja29yZGVyOiBzLmFsbG93QmFja29yZGVyLFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgLmV4ZWN1dGUoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGluc2VydGVkUHJvZHVjdDtcbiAgICB9KTtcblxuICAgIGNvbnNvbGUubG9nKCdbUE9TVF0gVHJhbnNhY3Rpb24gY29tcGxldGUuIEluc2VydGVkIHByb2R1Y3Q6JywgcHJvZHVjdCk7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHByb2R1Y3QsIHsgc3RhdHVzOiAyMDEgfSk7XG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICBjb25zb2xlLmVycm9yKCdbUE9TVF0gRXJyb3I6JywgZXJyb3IubWVzc2FnZSwgZXJyb3IpO1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSxcbiAgICAgIHsgc3RhdHVzOiBlcnJvci5tZXNzYWdlID09PSAnVW5hdXRob3JpemVkJyA/IDQwMSA6IDQwMCB9XG4gICAgKTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsImF1dGgiLCJkYiIsImdldE9yZ0lkT3JUaHJvdyIsInJlcSIsInNlc3Npb25SZXNwb25zZSIsImFwaSIsImdldFNlc3Npb24iLCJoZWFkZXJzIiwic2Vzc2lvbiIsIkVycm9yIiwiYWN0aXZlT3JnSWQiLCJhY3RpdmVPcmdhbml6YXRpb25JZCIsIkdFVCIsIm9yZ2FuaXphdGlvbklkIiwic2VhcmNoUGFyYW1zIiwiVVJMIiwidXJsIiwicGFyYW1JZCIsImdldCIsInBhcmFtU2t1IiwiZ2V0T25lUHJvZHVjdERldGFpbCIsImdldEFsbFBhcmVudFByb2R1Y3RzIiwiZXJyb3IiLCJjb25zb2xlIiwibWVzc2FnZSIsImpzb24iLCJzdGF0dXMiLCJwcm9kdWN0cyIsInNlbGVjdEZyb20iLCJzZWxlY3QiLCJ3aGVyZSIsIm9yZGVyQnkiLCJleGVjdXRlIiwicHJvZHVjdElkcyIsIm1hcCIsInAiLCJpZCIsImNhdGVnb3J5QXNzaWdubWVudHMiLCJpbm5lckpvaW4iLCJjYXRlZ29yaWVzQnlQcm9kdWN0SWQiLCJjYSIsInByb2R1Y3RJZCIsInB1c2giLCJjYXRlZ29yeUlkIiwiY2F0ZWdvcnlOYW1lIiwiY2F0ZWdvcnlQYXJlbnQiLCJ2YXJpYW50Um93cyIsImxlZnRKb2luIiwiYWdncmVnYXRlZFN0b2NrQnlQcm9kdWN0SWQiLCJtaW5QcmljZUJ5UHJvZHVjdElkIiwibWF4UHJpY2VCeVByb2R1Y3RJZCIsInZyIiwicGlkIiwic3RvY2tMZXZlbCIsInZQcmljZSIsInZhcmlhbnRQcmljZSIsInVuZGVmaW5lZCIsImZpbmFsIiwidG90YWxTdG9jayIsImNhdHMiLCJ2YXJpYWJsZU1pblByaWNlIiwidmFyaWFibGVNYXhQcmljZSIsInR5cGUiLCJuYW1lIiwic2t1IiwiaW1hZ2VVUkwiLCJwcmljZSIsImNhdGVnb3JpZXMiLCJwcm9kdWN0U2t1IiwicHJvZHVjdCIsInNlbGVjdEFsbCIsImV4ZWN1dGVUYWtlRmlyc3QiLCJ2YXJpYW50cyIsInZhcmlhbnRJZHMiLCJ2IiwiYWxsU3RvY2siLCJsZW5ndGgiLCJzdG9ja0J5VmFyaWFudElkIiwicyIsInZhcmlhbnRJZCIsInZhcmlhbnRUZXJtc1Jvd3MiLCJ0ZXJtc0J5VmFyaWFudElkIiwidnQiLCJhdHRyaWJ1dGVJZCIsInRlcm1OYW1lIiwic2x1ZyIsInRlcm1TbHVnIiwidmFyaWFudHNXaXRoU3RvY2siLCJzdG9jayIsInRlcm1zIiwiYXR0cmlidXRlQXNzaWdubWVudHMiLCJqb2luIiwib25SZWYiLCJhdHRyc0J5SWQiLCJyb3ciLCJhSWQiLCJ1c2VkRm9yVmFyaWF0aW9uIiwiYXR0cmlidXRlTmFtZSIsImF0dHJpYnV0ZVNsdWciLCJ0ZXJtSWQiLCJwcm9kdWN0QXR0cmlidXRlcyIsIk9iamVjdCIsInZhbHVlcyIsImZ1bGxQcm9kdWN0IiwiYXR0cmlidXRlcyIsIlBPU1QiLCJsb2ciLCJkZXNjcmlwdGlvbiIsInZhcmlhdGlvbnMiLCJjcnlwdG8iLCJyYW5kb21VVUlEIiwiY3JlYXRlZEF0IiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwidXBkYXRlZEF0IiwidHJhbnNhY3Rpb24iLCJ0cngiLCJwcm9kdWN0VmFsdWVzIiwiaW5zZXJ0ZWRQcm9kdWN0IiwiaW5zZXJ0SW50byIsInJldHVybmluZ0FsbCIsImV4ZWN1dGVUYWtlRmlyc3RPclRocm93IiwiYXR0ciIsImRiQXR0ciIsImZpbHRlciIsImZsYXRNYXAiLCJ2YXJpYW50SW5zZXJ0cyIsInZhcmlhbnQiLCJpbnNlcnRlZFZhcmlhbnRzIiwicmV0dXJuaW5nIiwidmFyaWFudFRlcm1zIiwiaW5kZXgiLCJ0ZXJtIiwiaSIsInZhcmlhdGlvbiIsInN0b2NrSW5zZXJ0cyIsInN0ayIsImNvdW50cnlDb2RlIiwibWFuYWdlU3RvY2siLCJ2aXNpYmlsaXR5IiwiYWxsb3dCYWNrb3JkZXIiLCJvbkNvbmZsaWN0Iiwib2MiLCJjb2x1bW5zIiwiZG9VcGRhdGVTZXQiLCJzaW1wbGVWYXJpYW50Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/products/route.ts\n");

/***/ }),

/***/ "(rsc)/./utils/auth.ts":
/*!***********************!*\
  !*** ./utils/auth.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   auth: () => (/* binding */ auth)\n/* harmony export */ });\n/* harmony import */ var better_auth__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! better-auth */ \"(rsc)/./node_modules/better-auth/dist/index.mjs\");\n/* harmony import */ var better_auth_next_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! better-auth/next-js */ \"(rsc)/./node_modules/better-auth/dist/integrations/next-js.mjs\");\n/* harmony import */ var better_auth_plugins__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! better-auth/plugins */ \"(rsc)/./node_modules/better-auth/dist/plugins/index.mjs\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/kysely/dist/esm/dialect/mysql/mysql-dialect.js\");\n/* harmony import */ var mysql2_promise__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! mysql2/promise */ \"(rsc)/./node_modules/mysql2/promise.js\");\n/* harmony import */ var better_sqlite3__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! better-sqlite3 */ \"better-sqlite3\");\n/* harmony import */ var better_sqlite3__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(better_sqlite3__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/kysely/dist/esm/dialect/sqlite/sqlite-dialect.js\");\n/* harmony import */ var _emails__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./emails */ \"(rsc)/./utils/emails.ts\");\n// /utils/auth.ts\n\n\n\n\n\n\n\n\nconst isProduction = \"development\" === \"production\";\nlet dialect;\nif (isProduction) {\n    dialect = new kysely__WEBPACK_IMPORTED_MODULE_6__.MysqlDialect({\n        pool: (0,mysql2_promise__WEBPACK_IMPORTED_MODULE_3__.createPool)({\n            host: process.env.MYSQL_HOST,\n            user: process.env.MYSQL_USER,\n            password: process.env.MYSQL_PASSWORD,\n            database: process.env.MYSQL_DATABASE\n        })\n    });\n} else {\n    dialect = new kysely__WEBPACK_IMPORTED_MODULE_7__.SqliteDialect({\n        database: new (better_sqlite3__WEBPACK_IMPORTED_MODULE_4___default())(\"./sqlite.db\")\n    });\n}\nconst auth = (0,better_auth__WEBPACK_IMPORTED_MODULE_0__.betterAuth)({\n    database: {\n        dialect,\n        type: isProduction ? \"mysql\" : \"sqlite\"\n    },\n    secret: process.env.BETTER_AUTH_SECRET,\n    url: process.env.BETTER_AUTH_URL,\n    emailAndPassword: {\n        enabled: true,\n        requireEmailVerification: true,\n        sendResetPassword: async ({ user, url, token }, request)=>{\n            await (0,_emails__WEBPACK_IMPORTED_MODULE_5__.sendEmail)({\n                to: user.email,\n                subject: \"Reset Your Password\",\n                text: `You requested a password reset. Click the link to reset your password: ${url}`\n            });\n        }\n    },\n    emailVerification: {\n        sendVerificationEmail: async ({ user, url, token }, request)=>{\n            await (0,_emails__WEBPACK_IMPORTED_MODULE_5__.sendEmail)({\n                to: user.email,\n                subject: \"Verify Your Email Address\",\n                text: `Thank you for signing up! Please verify your email by clicking this link: ${url}`\n            });\n        }\n    },\n    plugins: [\n        (0,better_auth_plugins__WEBPACK_IMPORTED_MODULE_2__.jwt)(),\n        (0,better_auth_plugins__WEBPACK_IMPORTED_MODULE_2__.admin)({\n            adminRole: [\n                \"admin\",\n                \"superAdmin\"\n            ],\n            defaultRole: \"user\",\n            impersonationSessionDuration: 60 * 60 * 24,\n            defaultBanReason: \"No reason\",\n            defaultBanExpiresIn: undefined\n        }),\n        (0,better_auth_plugins__WEBPACK_IMPORTED_MODULE_2__.organization)({\n            async sendInvitationEmail (data) {\n                const inviteLink = `${\"http://localhost:3000\"}/invite/${data.id}`;\n                await (0,_emails__WEBPACK_IMPORTED_MODULE_5__.sendEmail)({\n                    to: data.email,\n                    subject: \"You've been invited to join an organization\",\n                    text: `Hello!\\n\\nYou have been invited by ${data.inviter.user.name} (${data.inviter.user.email})\\nto join the organization \"${data.organization.name}\".\\n\\nPlease click the following link to accept the invitation:\\n${inviteLink}\\n\\nIf you did not expect this invitation, please ignore this email.`\n                });\n                console.log(\"Invitation email sent with link:\", inviteLink);\n            }\n        }),\n        (0,better_auth_plugins__WEBPACK_IMPORTED_MODULE_2__.magicLink)({\n            sendMagicLink: async ({ email, token, url }, request)=>{\n                await (0,_emails__WEBPACK_IMPORTED_MODULE_5__.sendEmail)({\n                    to: email,\n                    subject: \"Your Magic Link\",\n                    text: `Click this link to log in and accept your invitation: ${url}`\n                });\n            },\n            expiresIn: 300\n        }),\n        (0,better_auth_next_js__WEBPACK_IMPORTED_MODULE_1__.nextCookies)()\n    ],\n    // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\n    // NEW: databaseHooks to unset the active org ID when session is destroyed\n    databaseHooks: {\n        session: {\n            destroy: {\n                before: async (session, request)=>{\n                    // Force activeOrganizationId to null so it doesn't linger\n                    session.activeOrganizationId = null;\n                    // Return updated session so the library knows to handle it\n                    return {\n                        data: session\n                    };\n                }\n            }\n        }\n    }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNBMUQsZ0VBQVdBO0tBQ1o7SUFFRCxnRkFBZ0Y7SUFDaEYsMEVBQTBFO0lBQzFFMkQsZUFBZTtRQUNiQyxTQUFTO1lBQ1BDLFNBQVM7Z0JBQ1BDLFFBQVEsT0FBT0YsU0FBUzFCO29CQUN0QiwwREFBMEQ7b0JBQzFEMEIsUUFBUUcsb0JBQW9CLEdBQUc7b0JBQy9CLDJEQUEyRDtvQkFDM0QsT0FBTzt3QkFDTGQsTUFBTVc7b0JBQ1I7Z0JBQ0Y7WUFDRjtRQUNGO0lBQ0Y7QUFFRixHQUFHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdHJhcGlncmFtLy4vdXRpbHMvYXV0aC50cz9iMzhhIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIC91dGlscy9hdXRoLnRzXG5pbXBvcnQgeyBiZXR0ZXJBdXRoIH0gZnJvbSBcImJldHRlci1hdXRoXCI7XG5pbXBvcnQgeyBuZXh0Q29va2llcyB9IGZyb20gXCJiZXR0ZXItYXV0aC9uZXh0LWpzXCI7XG5pbXBvcnQgeyBqd3QsIGFkbWluLCBvcmdhbml6YXRpb24sIG1hZ2ljTGluayB9IGZyb20gXCJiZXR0ZXItYXV0aC9wbHVnaW5zXCI7IFxuaW1wb3J0IHsgTXlzcWxEaWFsZWN0IH0gZnJvbSBcImt5c2VseVwiO1xuaW1wb3J0IHsgY3JlYXRlUG9vbCB9IGZyb20gXCJteXNxbDIvcHJvbWlzZVwiO1xuaW1wb3J0IERhdGFiYXNlIGZyb20gXCJiZXR0ZXItc3FsaXRlM1wiO1xuaW1wb3J0IHsgU3FsaXRlRGlhbGVjdCB9IGZyb20gXCJreXNlbHlcIjtcbmltcG9ydCB7IHNlbmRFbWFpbCB9IGZyb20gXCIuL2VtYWlsc1wiO1xuXG5jb25zdCBpc1Byb2R1Y3Rpb24gPSBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gXCJwcm9kdWN0aW9uXCI7XG5cbmxldCBkaWFsZWN0O1xuaWYgKGlzUHJvZHVjdGlvbikge1xuICBkaWFsZWN0ID0gbmV3IE15c3FsRGlhbGVjdCh7XG4gICAgcG9vbDogY3JlYXRlUG9vbCh7XG4gICAgICBob3N0OiBwcm9jZXNzLmVudi5NWVNRTF9IT1NULFxuICAgICAgdXNlcjogcHJvY2Vzcy5lbnYuTVlTUUxfVVNFUixcbiAgICAgIHBhc3N3b3JkOiBwcm9jZXNzLmVudi5NWVNRTF9QQVNTV09SRCxcbiAgICAgIGRhdGFiYXNlOiBwcm9jZXNzLmVudi5NWVNRTF9EQVRBQkFTRSxcbiAgICB9KSxcbiAgfSk7XG59IGVsc2Uge1xuICBkaWFsZWN0ID0gbmV3IFNxbGl0ZURpYWxlY3Qoe1xuICAgIGRhdGFiYXNlOiBuZXcgRGF0YWJhc2UoXCIuL3NxbGl0ZS5kYlwiKSxcbiAgfSk7XG59XG5cbmV4cG9ydCBjb25zdCBhdXRoID0gYmV0dGVyQXV0aCh7XG4gIGRhdGFiYXNlOiB7XG4gICAgZGlhbGVjdCxcbiAgICB0eXBlOiBpc1Byb2R1Y3Rpb24gPyBcIm15c3FsXCIgOiBcInNxbGl0ZVwiLFxuICB9LFxuICBzZWNyZXQ6IHByb2Nlc3MuZW52LkJFVFRFUl9BVVRIX1NFQ1JFVCxcbiAgdXJsOiBwcm9jZXNzLmVudi5CRVRURVJfQVVUSF9VUkwsXG4gIGVtYWlsQW5kUGFzc3dvcmQ6IHtcbiAgICBlbmFibGVkOiB0cnVlLFxuICAgIHJlcXVpcmVFbWFpbFZlcmlmaWNhdGlvbjogdHJ1ZSxcbiAgICBzZW5kUmVzZXRQYXNzd29yZDogYXN5bmMgKHsgdXNlciwgdXJsLCB0b2tlbiB9LCByZXF1ZXN0KSA9PiB7XG4gICAgICBhd2FpdCBzZW5kRW1haWwoe1xuICAgICAgICB0bzogdXNlci5lbWFpbCxcbiAgICAgICAgc3ViamVjdDogXCJSZXNldCBZb3VyIFBhc3N3b3JkXCIsXG4gICAgICAgIHRleHQ6IGBZb3UgcmVxdWVzdGVkIGEgcGFzc3dvcmQgcmVzZXQuIENsaWNrIHRoZSBsaW5rIHRvIHJlc2V0IHlvdXIgcGFzc3dvcmQ6ICR7dXJsfWAsXG4gICAgICB9KTtcbiAgICB9LFxuICB9LFxuICBlbWFpbFZlcmlmaWNhdGlvbjoge1xuICAgIHNlbmRWZXJpZmljYXRpb25FbWFpbDogYXN5bmMgKHsgdXNlciwgdXJsLCB0b2tlbiB9LCByZXF1ZXN0KSA9PiB7XG4gICAgICBhd2FpdCBzZW5kRW1haWwoe1xuICAgICAgICB0bzogdXNlci5lbWFpbCxcbiAgICAgICAgc3ViamVjdDogXCJWZXJpZnkgWW91ciBFbWFpbCBBZGRyZXNzXCIsXG4gICAgICAgIHRleHQ6IGBUaGFuayB5b3UgZm9yIHNpZ25pbmcgdXAhIFBsZWFzZSB2ZXJpZnkgeW91ciBlbWFpbCBieSBjbGlja2luZyB0aGlzIGxpbms6ICR7dXJsfWAsXG4gICAgICB9KTtcbiAgICB9LFxuICB9LFxuICBwbHVnaW5zOiBbXG4gICAgand0KCksXG4gICAgYWRtaW4oe1xuICAgICAgYWRtaW5Sb2xlOiBbXCJhZG1pblwiLCBcInN1cGVyQWRtaW5cIl0sXG4gICAgICBkZWZhdWx0Um9sZTogXCJ1c2VyXCIsXG4gICAgICBpbXBlcnNvbmF0aW9uU2Vzc2lvbkR1cmF0aW9uOiA2MCAqIDYwICogMjQsIC8vIDEgZGF5XG4gICAgICBkZWZhdWx0QmFuUmVhc29uOiBcIk5vIHJlYXNvblwiLFxuICAgICAgZGVmYXVsdEJhbkV4cGlyZXNJbjogdW5kZWZpbmVkLFxuICAgIH0pLFxuICAgIG9yZ2FuaXphdGlvbih7XG4gICAgICBhc3luYyBzZW5kSW52aXRhdGlvbkVtYWlsKGRhdGEpIHtcbiAgICAgICAgY29uc3QgaW52aXRlTGluayA9IGAke3Byb2Nlc3MuZW52Lk5FWFRfUFVCTElDX0JBU0VfVVJMfS9pbnZpdGUvJHtkYXRhLmlkfWA7XG4gICAgICAgIGF3YWl0IHNlbmRFbWFpbCh7XG4gICAgICAgICAgdG86IGRhdGEuZW1haWwsXG4gICAgICAgICAgc3ViamVjdDogXCJZb3UndmUgYmVlbiBpbnZpdGVkIHRvIGpvaW4gYW4gb3JnYW5pemF0aW9uXCIsXG4gICAgICAgICAgdGV4dDogYEhlbGxvIVxcblxcbllvdSBoYXZlIGJlZW4gaW52aXRlZCBieSAke2RhdGEuaW52aXRlci51c2VyLm5hbWV9ICgke2RhdGEuaW52aXRlci51c2VyLmVtYWlsfSlcXG50byBqb2luIHRoZSBvcmdhbml6YXRpb24gXCIke2RhdGEub3JnYW5pemF0aW9uLm5hbWV9XCIuXFxuXFxuUGxlYXNlIGNsaWNrIHRoZSBmb2xsb3dpbmcgbGluayB0byBhY2NlcHQgdGhlIGludml0YXRpb246XFxuJHtpbnZpdGVMaW5rfVxcblxcbklmIHlvdSBkaWQgbm90IGV4cGVjdCB0aGlzIGludml0YXRpb24sIHBsZWFzZSBpZ25vcmUgdGhpcyBlbWFpbC5gLFxuICAgICAgICB9KTtcbiAgICAgICAgY29uc29sZS5sb2coXCJJbnZpdGF0aW9uIGVtYWlsIHNlbnQgd2l0aCBsaW5rOlwiLCBpbnZpdGVMaW5rKTtcbiAgICAgIH0sXG4gICAgfSksXG4gICAgbWFnaWNMaW5rKHtcbiAgICAgIHNlbmRNYWdpY0xpbms6IGFzeW5jICh7IGVtYWlsLCB0b2tlbiwgdXJsIH0sIHJlcXVlc3QpID0+IHtcbiAgICAgICAgYXdhaXQgc2VuZEVtYWlsKHtcbiAgICAgICAgICB0bzogZW1haWwsXG4gICAgICAgICAgc3ViamVjdDogXCJZb3VyIE1hZ2ljIExpbmtcIixcbiAgICAgICAgICB0ZXh0OiBgQ2xpY2sgdGhpcyBsaW5rIHRvIGxvZyBpbiBhbmQgYWNjZXB0IHlvdXIgaW52aXRhdGlvbjogJHt1cmx9YCxcbiAgICAgICAgfSk7XG4gICAgICB9LFxuICAgICAgZXhwaXJlc0luOiAzMDAsIC8vIDUgbWludXRlc1xuICAgIH0pLFxuICAgIG5leHRDb29raWVzKCksXG4gIF0sXG5cbiAgLy8gPj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj5cbiAgLy8gTkVXOiBkYXRhYmFzZUhvb2tzIHRvIHVuc2V0IHRoZSBhY3RpdmUgb3JnIElEIHdoZW4gc2Vzc2lvbiBpcyBkZXN0cm95ZWRcbiAgZGF0YWJhc2VIb29rczoge1xuICAgIHNlc3Npb246IHtcbiAgICAgIGRlc3Ryb3k6IHtcbiAgICAgICAgYmVmb3JlOiBhc3luYyAoc2Vzc2lvbiwgcmVxdWVzdCkgPT4ge1xuICAgICAgICAgIC8vIEZvcmNlIGFjdGl2ZU9yZ2FuaXphdGlvbklkIHRvIG51bGwgc28gaXQgZG9lc24ndCBsaW5nZXJcbiAgICAgICAgICBzZXNzaW9uLmFjdGl2ZU9yZ2FuaXphdGlvbklkID0gbnVsbDtcbiAgICAgICAgICAvLyBSZXR1cm4gdXBkYXRlZCBzZXNzaW9uIHNvIHRoZSBsaWJyYXJ5IGtub3dzIHRvIGhhbmRsZSBpdFxuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBkYXRhOiBzZXNzaW9uLFxuICAgICAgICAgIH07XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH0sXG4gIH0sXG4gIC8vIDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDxcbn0pO1xuIl0sIm5hbWVzIjpbImJldHRlckF1dGgiLCJuZXh0Q29va2llcyIsImp3dCIsImFkbWluIiwib3JnYW5pemF0aW9uIiwibWFnaWNMaW5rIiwiTXlzcWxEaWFsZWN0IiwiY3JlYXRlUG9vbCIsIkRhdGFiYXNlIiwiU3FsaXRlRGlhbGVjdCIsInNlbmRFbWFpbCIsImlzUHJvZHVjdGlvbiIsInByb2Nlc3MiLCJkaWFsZWN0IiwicG9vbCIsImhvc3QiLCJlbnYiLCJNWVNRTF9IT1NUIiwidXNlciIsIk1ZU1FMX1VTRVIiLCJwYXNzd29yZCIsIk1ZU1FMX1BBU1NXT1JEIiwiZGF0YWJhc2UiLCJNWVNRTF9EQVRBQkFTRSIsImF1dGgiLCJ0eXBlIiwic2VjcmV0IiwiQkVUVEVSX0FVVEhfU0VDUkVUIiwidXJsIiwiQkVUVEVSX0FVVEhfVVJMIiwiZW1haWxBbmRQYXNzd29yZCIsImVuYWJsZWQiLCJyZXF1aXJlRW1haWxWZXJpZmljYXRpb24iLCJzZW5kUmVzZXRQYXNzd29yZCIsInRva2VuIiwicmVxdWVzdCIsInRvIiwiZW1haWwiLCJzdWJqZWN0IiwidGV4dCIsImVtYWlsVmVyaWZpY2F0aW9uIiwic2VuZFZlcmlmaWNhdGlvbkVtYWlsIiwicGx1Z2lucyIsImFkbWluUm9sZSIsImRlZmF1bHRSb2xlIiwiaW1wZXJzb25hdGlvblNlc3Npb25EdXJhdGlvbiIsImRlZmF1bHRCYW5SZWFzb24iLCJkZWZhdWx0QmFuRXhwaXJlc0luIiwidW5kZWZpbmVkIiwic2VuZEludml0YXRpb25FbWFpbCIsImRhdGEiLCJpbnZpdGVMaW5rIiwiTkVYVF9QVUJMSUNfQkFTRV9VUkwiLCJpZCIsImludml0ZXIiLCJuYW1lIiwiY29uc29sZSIsImxvZyIsInNlbmRNYWdpY0xpbmsiLCJleHBpcmVzSW4iLCJkYXRhYmFzZUhvb2tzIiwic2Vzc2lvbiIsImRlc3Ryb3kiLCJiZWZvcmUiLCJhY3RpdmVPcmdhbml6YXRpb25JZCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./utils/auth.ts\n");

/***/ }),

/***/ "(rsc)/./utils/db.ts":
/*!*********************!*\
  !*** ./utils/db.ts ***!
  \*********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   db: () => (/* binding */ db)\n/* harmony export */ });\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/kysely/dist/esm/kysely.js\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/kysely/dist/esm/dialect/sqlite/sqlite-dialect.js\");\n/* harmony import */ var better_sqlite3__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! better-sqlite3 */ \"better-sqlite3\");\n/* harmony import */ var better_sqlite3__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(better_sqlite3__WEBPACK_IMPORTED_MODULE_1__);\n// /home/zodx/Desktop/proyectx/utils/db.ts\n\n\n\n// IMPORTANT: Always use an absolute path so that both\n// the API routes and the layout code read the SAME file\nconst dbFilePath = path__WEBPACK_IMPORTED_MODULE_0___default().join(process.cwd(), \"sqlite.db\");\nconsole.log(\"[DB] Using DB file:\", dbFilePath);\nconst db = new kysely__WEBPACK_IMPORTED_MODULE_2__.Kysely({\n    dialect: new kysely__WEBPACK_IMPORTED_MODULE_3__.SqliteDialect({\n        database: new (better_sqlite3__WEBPACK_IMPORTED_MODULE_1___default())(dbFilePath)\n    })\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi91dGlscy9kYi50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQUEsMENBQTBDO0FBRWxCO0FBQ3VCO0FBQ1Q7QUFtUXRDLHNEQUFzRDtBQUN0RCx3REFBd0Q7QUFDeEQsTUFBTUksYUFBYUosZ0RBQVMsQ0FBQ00sUUFBUUMsR0FBRyxJQUFJO0FBQzVDQyxRQUFRQyxHQUFHLENBQUMsdUJBQXVCTDtBQUU1QixNQUFNTSxLQUFLLElBQUlULDBDQUFNQSxDQUFpQjtJQUMzQ1UsU0FBUyxJQUFJVCxpREFBYUEsQ0FBQztRQUN6QlUsVUFBVSxJQUFJVCx1REFBUUEsQ0FBQ0M7SUFDekI7QUFDRixHQUFHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdHJhcGlncmFtLy4vdXRpbHMvZGIudHM/Y2Q3YiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyAvaG9tZS96b2R4L0Rlc2t0b3AvcHJveWVjdHgvdXRpbHMvZGIudHNcblxuaW1wb3J0IHBhdGggZnJvbSBcInBhdGhcIjtcbmltcG9ydCB7IEt5c2VseSwgU3FsaXRlRGlhbGVjdCB9IGZyb20gXCJreXNlbHlcIjtcbmltcG9ydCBEYXRhYmFzZSBmcm9tIFwiYmV0dGVyLXNxbGl0ZTNcIjtcblxuLyoqXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqIFRBQkxFIElOVEVSRkFDRVNcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICovXG5cbi8vIC0tLS0tLS0tLS0tLS0tIEJhc2ljIEF1dGggLyBQbGF0Zm9ybSBUYWJsZXMgLS0tLS0tLS0tLS0tLS1cbmludGVyZmFjZSBVc2VyVGFibGUge1xuICBpZDogc3RyaW5nO1xuICBuYW1lOiBzdHJpbmc7XG4gIGVtYWlsOiBzdHJpbmc7XG4gIGVtYWlsVmVyaWZpZWQ6IG51bWJlcjsgLy8gb3IgYm9vbGVhblxuICBpbWFnZT86IHN0cmluZztcbiAgY3JlYXRlZEF0OiBzdHJpbmc7XG4gIHVwZGF0ZWRBdDogc3RyaW5nO1xuICByb2xlPzogc3RyaW5nO1xuICBiYW5uZWQ/OiBudW1iZXI7XG4gIGJhblJlYXNvbj86IHN0cmluZztcbiAgYmFuRXhwaXJlcz86IHN0cmluZztcbiAgb25ib2FyZGluZ0NvbXBsZXRlZDogbnVtYmVyOyAvLyBzdG9yZSBhcyBpbnRlZ2VyIDAgb3IgMVxufVxuXG5pbnRlcmZhY2UgU2Vzc2lvblRhYmxlIHtcbiAgaWQ6IHN0cmluZztcbiAgZXhwaXJlc0F0OiBzdHJpbmc7XG4gIHRva2VuOiBzdHJpbmc7XG4gIGNyZWF0ZWRBdDogc3RyaW5nO1xuICB1cGRhdGVkQXQ/OiBzdHJpbmc7XG4gIGlwQWRkcmVzcz86IHN0cmluZztcbiAgdXNlckFnZW50Pzogc3RyaW5nO1xuICB1c2VySWQ6IHN0cmluZztcbiAgaW1wZXJzb25hdGVkQnk/OiBzdHJpbmc7XG4gIGFjdGl2ZU9yZ2FuaXphdGlvbklkPzogc3RyaW5nO1xufVxuXG5pbnRlcmZhY2UgQWNjb3VudFRhYmxlIHtcbiAgaWQ6IHN0cmluZztcbiAgYWNjb3VudElkOiBzdHJpbmc7XG4gIHByb3ZpZGVySWQ6IHN0cmluZztcbiAgdXNlcklkOiBzdHJpbmc7XG4gIGFjY2Vzc1Rva2VuPzogc3RyaW5nO1xuICByZWZyZXNoVG9rZW4/OiBzdHJpbmc7XG4gIGlkVG9rZW4/OiBzdHJpbmc7XG4gIGFjY2Vzc1Rva2VuRXhwaXJlc0F0Pzogc3RyaW5nO1xuICByZWZyZXNoVG9rZW5FeHBpcmVzQXQ/OiBzdHJpbmc7XG4gIHNjb3BlPzogc3RyaW5nO1xuICBwYXNzd29yZD86IHN0cmluZztcbiAgY3JlYXRlZEF0OiBzdHJpbmc7XG4gIHVwZGF0ZWRBdDogc3RyaW5nO1xufVxuXG5pbnRlcmZhY2UgVmVyaWZpY2F0aW9uVGFibGUge1xuICBpZDogc3RyaW5nO1xuICBpZGVudGlmaWVyOiBzdHJpbmc7XG4gIHZhbHVlOiBzdHJpbmc7XG4gIGV4cGlyZXNBdDogc3RyaW5nO1xuICBjcmVhdGVkQXQ/OiBzdHJpbmc7XG4gIHVwZGF0ZWRBdD86IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIFRlbmFudFRhYmxlIHtcbiAgaWQ6IG51bWJlcjtcbiAgb3duZXJVc2VySWQ6IHN0cmluZztcbiAgbmFtZTogc3RyaW5nIHwgbnVsbDtcbiAgY3JlYXRlZEF0OiBzdHJpbmc7XG4gIHVwZGF0ZWRBdDogc3RyaW5nO1xuICBlbmNyeXB0ZWRTZWNyZXRQaHJhc2U6IHN0cmluZyB8IG51bGw7XG4gIG9uYm9hcmRpbmdDb21wbGV0ZWQ6IG51bWJlcjsgLy8gMCBvciAxIChzdG9yZWQgYXMgSU5URUdFUilcbn1cblxuaW50ZXJmYWNlIFRlbmFudFBsYXRmb3JtVGFibGUge1xuICBpZDogbnVtYmVyO1xuICB0ZW5hbnRJZDogbnVtYmVyO1xuICBwbGF0Zm9ybU5hbWU6IHN0cmluZztcbiAgZW5jcnlwdGVkQXBpS2V5OiBzdHJpbmc7XG4gIGNyZWF0ZWRBdDogc3RyaW5nO1xuICB1cGRhdGVkQXQ6IHN0cmluZztcbiAgb3JnYW5pemF0aW9uSWQ6IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIE9yZ2FuaXphdGlvblRhYmxlIHtcbiAgaWQ6IHN0cmluZztcbiAgbmFtZTogc3RyaW5nO1xuICBzbHVnOiBzdHJpbmc7XG4gIGxvZ286IHN0cmluZyB8IG51bGw7XG4gIGNyZWF0ZWRBdDogc3RyaW5nO1xuICBtZXRhZGF0YTogc3RyaW5nIHwgbnVsbDtcbn1cblxuaW50ZXJmYWNlIE1lbWJlclRhYmxlIHtcbiAgaWQ6IHN0cmluZztcbiAgb3JnYW5pemF0aW9uSWQ6IHN0cmluZztcbiAgdXNlcklkOiBzdHJpbmc7XG4gIHJvbGU6IHN0cmluZztcbiAgY3JlYXRlZEF0OiBzdHJpbmc7XG59XG5cbmludGVyZmFjZSBJbnZpdGF0aW9uVGFibGUge1xuICBpZDogc3RyaW5nO1xuICBvcmdhbml6YXRpb25JZDogc3RyaW5nO1xuICBlbWFpbDogc3RyaW5nO1xuICByb2xlOiBzdHJpbmcgfCBudWxsO1xuICBzdGF0dXM6IHN0cmluZztcbiAgZXhwaXJlc0F0OiBzdHJpbmc7XG4gIGludml0ZXJJZDogc3RyaW5nO1xufVxuXG5pbnRlcmZhY2UgSldLU1RhYmxlIHtcbiAgaWQ6IHN0cmluZztcbiAgcHVibGljS2V5OiBzdHJpbmc7XG4gIHByaXZhdGVLZXk6IHN0cmluZztcbiAgY3JlYXRlZEF0OiBzdHJpbmc7XG59XG5cbmludGVyZmFjZSBPcmdhbml6YXRpb25Db3VudHJpZXNUYWJsZSB7XG4gIGlkOiBzdHJpbmc7XG4gIG9yZ2FuaXphdGlvbklkOiBzdHJpbmc7XG4gIGNvdW50cnlDb2RlOiBzdHJpbmc7XG4gIGxvZ2lzdGljc19ncm91cDogbnVtYmVyIHwgbnVsbDsgLy8gQmlnaW50IHN0b3JlZCBhcyBJTlRFR0VSIGluIFNRTGl0ZVxuICBzdXBwb3J0X2dyb3VwOiBudW1iZXIgfCBudWxsOyAgIC8vIEJpZ2ludCBzdG9yZWQgYXMgSU5URUdFUiBpbiBTUUxpdGVcbiAgY3JlYXRlZEF0OiBzdHJpbmc7XG4gIHVwZGF0ZWRBdDogc3RyaW5nO1xufVxuXG5pbnRlcmZhY2UgT3JnYW5pemF0aW9uU3VwcG9ydEVtYWlsVGFibGUge1xuICBpZDogc3RyaW5nO1xuICBvcmdhbml6YXRpb25JZDogc3RyaW5nO1xuICB1c2VySWQ6IHN0cmluZztcbiAgZW5jcnlwdGVkU3VwcG9ydEVtYWlsOiBzdHJpbmc7XG4gIGNyZWF0ZWRBdDogc3RyaW5nO1xuICB1cGRhdGVkQXQ6IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIFByb2R1Y3RDYXRlZ29yeVRhYmxlIHtcbiAgaWQ6IHN0cmluZztcbiAgbmFtZTogc3RyaW5nO1xuICBpbWFnZTogc3RyaW5nIHwgbnVsbDtcbiAgc2x1Zzogc3RyaW5nO1xuICBvcmdhbml6YXRpb25JZDogc3RyaW5nO1xuICBwYXJlbnRJZDogc3RyaW5nIHwgbnVsbDtcbn1cblxuLy8gLS0tLS0tLS0tLS0tLS0gUHJvZHVjdCAmIEUtY29tbWVyY2UgVGFibGVzIC0tLS0tLS0tLS0tLS0tXG5pbnRlcmZhY2UgUHJvZHVjdEF0dHJpYnV0ZVRhYmxlIHtcbiAgaWQ6IHN0cmluZztcbiAgbmFtZTogc3RyaW5nO1xuICBzbHVnOiBzdHJpbmc7XG4gIG9yZ2FuaXphdGlvbklkOiBzdHJpbmc7XG59XG5cbmludGVyZmFjZSBQcm9kdWN0QXR0cmlidXRlVGVybVRhYmxlIHtcbiAgaWQ6IHN0cmluZztcbiAgYXR0cmlidXRlSWQ6IHN0cmluZztcbiAgbmFtZTogc3RyaW5nO1xuICBzbHVnOiBzdHJpbmc7XG4gIG9yZ2FuaXphdGlvbklkOiBzdHJpbmc7XG59XG5cbmludGVyZmFjZSBQcm9kdWN0QXR0cmlidXRlQXNzaWdubWVudFRhYmxlIHtcbiAgaWQ6IHN0cmluZztcbiAgcHJvZHVjdElkOiBzdHJpbmc7XG4gIGF0dHJpYnV0ZUlkOiBzdHJpbmc7XG4gIHVzZWRGb3JWYXJpYXRpb246IG51bWJlcjsgLy8gMCBvciAxXG4gIG9yZ2FuaXphdGlvbklkOiBzdHJpbmc7XG59XG5cbmludGVyZmFjZSBQcm9kdWN0VGVybVRhYmxlIHtcbiAgaWQ6IHN0cmluZztcbiAgcHJvZHVjdElkOiBzdHJpbmc7XG4gIGF0dHJpYnV0ZUlkOiBzdHJpbmc7XG4gIHRlcm1JZDogc3RyaW5nO1xuICBvcmdhbml6YXRpb25JZDogc3RyaW5nO1xufVxuXG5pbnRlcmZhY2UgUHJvZHVjdFZhcmlhbnRUZXJtVGFibGUge1xuICBpZDogc3RyaW5nO1xuICB2YXJpYW50SWQ6IHN0cmluZztcbiAgYXR0cmlidXRlSWQ6IHN0cmluZztcbiAgdGVybUlkOiBzdHJpbmc7XG4gIG9yZ2FuaXphdGlvbklkOiBzdHJpbmc7XG59XG5cbmludGVyZmFjZSBQcm9kdWN0U3RvY2tUYWJsZSB7XG4gIGlkOiBzdHJpbmc7XG4gIHZhcmlhbnRJZDogc3RyaW5nOyAgLy8gcmVmZXJlbmNlcyBwcm9kdWN0X3ZhcmlhbnRzKGlkKVxuICBjb3VudHJ5Q29kZTogc3RyaW5nO1xuICBzdG9ja0xldmVsOiBudW1iZXI7XG4gIHZpc2liaWxpdHk6IG51bWJlcjsgICAgIC8vIDAgb3IgMVxuICBtYW5hZ2VTdG9jazogbnVtYmVyOyAgICAvLyAwIG9yIDFcbiAgYWxsb3dCYWNrb3JkZXI6IG51bWJlcjsgLy8gMCBvciAxXG4gIG9yZ2FuaXphdGlvbklkOiBzdHJpbmc7XG59XG5cbi8qKiBcbiAqIE5FVyBJTUFHRSBDT0xVTU46XG4gKiAgLSBBZGQgYGltYWdlVVJMPzogc3RyaW5nIHwgbnVsbDtgIHRvIFByb2R1Y3RUYWJsZVxuICogIC0gQWRkIGBpbWFnZVVSTD86IHN0cmluZyB8IG51bGw7YCB0byBQcm9kdWN0VmFyaWFudFRhYmxlXG4gKi9cbmludGVyZmFjZSBQcm9kdWN0VGFibGUge1xuICBpZDogc3RyaW5nO1xuICBvcmdhbml6YXRpb25JZDogc3RyaW5nO1xuICBuYW1lOiBzdHJpbmc7XG4gIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG4gIHR5cGU6ICdzaW1wbGUnIHwgJ3ZhcmlhYmxlJztcbiAgc2t1OiBzdHJpbmcgfCBudWxsO1xuICBwcmljZTogbnVtYmVyIHwgbnVsbDtcbiAgc3RhdHVzOiAnZHJhZnQnIHwgJ3B1Ymxpc2hlZCcgfCAnYXJjaGl2ZWQnO1xuICBjcmVhdGVkQXQ6IHN0cmluZztcbiAgdXBkYXRlZEF0OiBzdHJpbmc7XG4gIGltYWdlVVJMPzogc3RyaW5nIHwgbnVsbDsgLy8gPC0tLSBORVcgY29sdW1uXG59XG5cbmludGVyZmFjZSBQcm9kdWN0VmFyaWFudFRhYmxlIHtcbiAgaWQ6IHN0cmluZztcbiAgcHJvZHVjdElkOiBzdHJpbmc7XG4gIG9yZ2FuaXphdGlvbklkOiBzdHJpbmc7XG4gIHNrdTogc3RyaW5nO1xuICBwcmljZTogbnVtYmVyO1xuICBjcmVhdGVkQXQ6IHN0cmluZztcbiAgdXBkYXRlZEF0OiBzdHJpbmc7XG4gIGltYWdlVVJMPzogc3RyaW5nIHwgbnVsbDsgLy8gPC0tLSBORVcgY29sdW1uXG59XG5cbmludGVyZmFjZSBQcm9kdWN0Q2F0ZWdvcnlBc3NpZ25tZW50VGFibGUge1xuICBpZDogc3RyaW5nO1xuICBwcm9kdWN0SWQ6IHN0cmluZztcbiAgY2F0ZWdvcnlJZDogc3RyaW5nO1xuICBvcmdhbml6YXRpb25JZDogc3RyaW5nO1xufVxuXG4vLyAtLS0tLS0tLS0tLS0tLSBDT01CSU5FRCBTQ0hFTUEgZm9yIEt5c2VseSAtLS0tLS0tLS0tLS0tLVxuaW50ZXJmYWNlIERhdGFiYXNlU2NoZW1hIHtcbiAgdXNlcjogVXNlclRhYmxlO1xuICBzZXNzaW9uOiBTZXNzaW9uVGFibGU7XG4gIGFjY291bnQ6IEFjY291bnRUYWJsZTtcbiAgdmVyaWZpY2F0aW9uOiBWZXJpZmljYXRpb25UYWJsZTtcbiAgdGVuYW50OiBUZW5hbnRUYWJsZTtcbiAgdGVuYW50X3BsYXRmb3JtczogVGVuYW50UGxhdGZvcm1UYWJsZTtcbiAgb3JnYW5pemF0aW9uOiBPcmdhbml6YXRpb25UYWJsZTtcbiAgb3JnYW5pemF0aW9uX3N1cHBvcnRfZW1haWw6IE9yZ2FuaXphdGlvblN1cHBvcnRFbWFpbFRhYmxlO1xuICBvcmdhbml6YXRpb25fY291bnRyaWVzOiBPcmdhbml6YXRpb25Db3VudHJpZXNUYWJsZTtcbiAgbWVtYmVyOiBNZW1iZXJUYWJsZTtcbiAgaW52aXRhdGlvbjogSW52aXRhdGlvblRhYmxlO1xuICBqd2tzOiBKV0tTVGFibGU7XG5cbiAgcHJvZHVjdF9jYXRlZ29yaWVzOiBQcm9kdWN0Q2F0ZWdvcnlUYWJsZTtcbiAgcHJvZHVjdF9hdHRyaWJ1dGVzOiBQcm9kdWN0QXR0cmlidXRlVGFibGU7XG4gIHByb2R1Y3RfYXR0cmlidXRlX3Rlcm1zOiBQcm9kdWN0QXR0cmlidXRlVGVybVRhYmxlO1xuICBwcm9kdWN0X2F0dHJpYnV0ZV9hc3NpZ25tZW50czogUHJvZHVjdEF0dHJpYnV0ZUFzc2lnbm1lbnRUYWJsZTtcbiAgcHJvZHVjdDogUHJvZHVjdFRhYmxlO1xuICBwcm9kdWN0X3ZhcmlhbnRzOiBQcm9kdWN0VmFyaWFudFRhYmxlO1xuICBwcm9kdWN0X2NhdGVnb3J5X2Fzc2lnbm1lbnRzOiBQcm9kdWN0Q2F0ZWdvcnlBc3NpZ25tZW50VGFibGU7XG4gIHByb2R1Y3RfdGVybTogUHJvZHVjdFRlcm1UYWJsZTtcbiAgcHJvZHVjdF92YXJpYW50X3Rlcm1zOiBQcm9kdWN0VmFyaWFudFRlcm1UYWJsZTtcbiAgcHJvZHVjdF9zdG9jazogUHJvZHVjdFN0b2NrVGFibGU7XG59XG5cbi8vIElNUE9SVEFOVDogQWx3YXlzIHVzZSBhbiBhYnNvbHV0ZSBwYXRoIHNvIHRoYXQgYm90aFxuLy8gdGhlIEFQSSByb3V0ZXMgYW5kIHRoZSBsYXlvdXQgY29kZSByZWFkIHRoZSBTQU1FIGZpbGVcbmNvbnN0IGRiRmlsZVBhdGggPSBwYXRoLmpvaW4ocHJvY2Vzcy5jd2QoKSwgXCJzcWxpdGUuZGJcIik7XG5jb25zb2xlLmxvZyhcIltEQl0gVXNpbmcgREIgZmlsZTpcIiwgZGJGaWxlUGF0aCk7XG5cbmV4cG9ydCBjb25zdCBkYiA9IG5ldyBLeXNlbHk8RGF0YWJhc2VTY2hlbWE+KHtcbiAgZGlhbGVjdDogbmV3IFNxbGl0ZURpYWxlY3Qoe1xuICAgIGRhdGFiYXNlOiBuZXcgRGF0YWJhc2UoZGJGaWxlUGF0aCksXG4gIH0pLFxufSk7XG4iXSwibmFtZXMiOlsicGF0aCIsIkt5c2VseSIsIlNxbGl0ZURpYWxlY3QiLCJEYXRhYmFzZSIsImRiRmlsZVBhdGgiLCJqb2luIiwicHJvY2VzcyIsImN3ZCIsImNvbnNvbGUiLCJsb2ciLCJkYiIsImRpYWxlY3QiLCJkYXRhYmFzZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./utils/db.ts\n");

/***/ }),

/***/ "(rsc)/./utils/emails.ts":
/*!*************************!*\
  !*** ./utils/emails.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   sendEmail: () => (/* binding */ sendEmail)\n/* harmony export */ });\n/* harmony import */ var nodemailer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! nodemailer */ \"(rsc)/./node_modules/nodemailer/lib/nodemailer.js\");\n// utils/email.ts\n\nasync function sendEmail({ to, subject, text, html }) {\n    let transporter;\n    if (true) {\n        // Create a test account for development (Ethereal)\n        const testAccount = await nodemailer__WEBPACK_IMPORTED_MODULE_0__.createTestAccount();\n        transporter = nodemailer__WEBPACK_IMPORTED_MODULE_0__.createTransport({\n            host: testAccount.smtp.host,\n            port: testAccount.smtp.port,\n            secure: testAccount.smtp.secure,\n            auth: {\n                user: testAccount.user,\n                pass: testAccount.pass\n            }\n        });\n    } else {}\n    try {\n        const info = await transporter.sendMail({\n            from: '\"Your App\" <no-reply@yourapp.com>',\n            to,\n            subject,\n            text,\n            html\n        });\n        // In development, log the preview URL\n        if (true) {\n            console.log(\"Email preview URL:\", nodemailer__WEBPACK_IMPORTED_MODULE_0__.getTestMessageUrl(info));\n        }\n    } catch (error) {\n        console.error(\"Error sending email:\", error);\n        throw error;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi91dGlscy9lbWFpbHMudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxpQkFBaUI7QUFDbUI7QUFTN0IsZUFBZUMsVUFBVSxFQUFFQyxFQUFFLEVBQUVDLE9BQU8sRUFBRUMsSUFBSSxFQUFFQyxJQUFJLEVBQW9CO0lBQzNFLElBQUlDO0lBRUosSUFBSUMsSUFBeUIsRUFBYztRQUN6QyxtREFBbUQ7UUFDbkQsTUFBTUMsY0FBYyxNQUFNUix5REFBNEI7UUFDdERNLGNBQWNOLHVEQUEwQixDQUFDO1lBQ3ZDVyxNQUFNSCxZQUFZSSxJQUFJLENBQUNELElBQUk7WUFDM0JFLE1BQU1MLFlBQVlJLElBQUksQ0FBQ0MsSUFBSTtZQUMzQkMsUUFBUU4sWUFBWUksSUFBSSxDQUFDRSxNQUFNO1lBQy9CQyxNQUFNO2dCQUNKQyxNQUFNUixZQUFZUSxJQUFJO2dCQUN0QkMsTUFBTVQsWUFBWVMsSUFBSTtZQUN4QjtRQUNGO0lBQ0YsT0FBTyxFQVdOO0lBRUQsSUFBSTtRQUNGLE1BQU1RLE9BQU8sTUFBTW5CLFlBQVlvQixRQUFRLENBQUM7WUFDdENDLE1BQU07WUFDTnpCO1lBQ0FDO1lBQ0FDO1lBQ0FDO1FBQ0Y7UUFFQSxzQ0FBc0M7UUFDdEMsSUFBSUUsSUFBeUIsRUFBYztZQUN6Q3FCLFFBQVFDLEdBQUcsQ0FBQyxzQkFBc0I3Qix5REFBNEIsQ0FBQ3lCO1FBQ2pFO0lBQ0YsRUFBRSxPQUFPTSxPQUFPO1FBQ2RILFFBQVFHLEtBQUssQ0FBQyx3QkFBd0JBO1FBQ3RDLE1BQU1BO0lBQ1I7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3RyYXBpZ3JhbS8uL3V0aWxzL2VtYWlscy50cz80OWZiIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHV0aWxzL2VtYWlsLnRzXG5pbXBvcnQgbm9kZW1haWxlciBmcm9tICdub2RlbWFpbGVyJztcblxuaW50ZXJmYWNlIFNlbmRFbWFpbE9wdGlvbnMge1xuICB0bzogc3RyaW5nO1xuICBzdWJqZWN0OiBzdHJpbmc7XG4gIHRleHQ6IHN0cmluZztcbiAgaHRtbD86IHN0cmluZzsgLy8gT3B0aW9uYWwgSFRNTCBjb250ZW50XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzZW5kRW1haWwoeyB0bywgc3ViamVjdCwgdGV4dCwgaHRtbCB9OiBTZW5kRW1haWxPcHRpb25zKSB7XG4gIGxldCB0cmFuc3BvcnRlcjtcblxuICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgIC8vIENyZWF0ZSBhIHRlc3QgYWNjb3VudCBmb3IgZGV2ZWxvcG1lbnQgKEV0aGVyZWFsKVxuICAgIGNvbnN0IHRlc3RBY2NvdW50ID0gYXdhaXQgbm9kZW1haWxlci5jcmVhdGVUZXN0QWNjb3VudCgpO1xuICAgIHRyYW5zcG9ydGVyID0gbm9kZW1haWxlci5jcmVhdGVUcmFuc3BvcnQoe1xuICAgICAgaG9zdDogdGVzdEFjY291bnQuc210cC5ob3N0LFxuICAgICAgcG9ydDogdGVzdEFjY291bnQuc210cC5wb3J0LFxuICAgICAgc2VjdXJlOiB0ZXN0QWNjb3VudC5zbXRwLnNlY3VyZSwgLy8gdHJ1ZSBmb3IgNDY1LCBmYWxzZSBmb3Igb3RoZXIgcG9ydHNcbiAgICAgIGF1dGg6IHtcbiAgICAgICAgdXNlcjogdGVzdEFjY291bnQudXNlcixcbiAgICAgICAgcGFzczogdGVzdEFjY291bnQucGFzcyxcbiAgICAgIH0sXG4gICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgLy8gVXNlIHByb2R1Y3Rpb24gU01UUCBzZXR0aW5ncyAoZW5zdXJlIHRoZXNlIGVudiB2YXJpYWJsZXMgYXJlIHNldClcbiAgICB0cmFuc3BvcnRlciA9IG5vZGVtYWlsZXIuY3JlYXRlVHJhbnNwb3J0KHtcbiAgICAgIGhvc3Q6IHByb2Nlc3MuZW52LlNNVFBfSE9TVCEsXG4gICAgICBwb3J0OiBOdW1iZXIocHJvY2Vzcy5lbnYuU01UUF9QT1JUKSxcbiAgICAgIHNlY3VyZTogcHJvY2Vzcy5lbnYuU01UUF9TRUNVUkUgPT09ICd0cnVlJywgLy8gdHJ1ZSBmb3IgcG9ydCA0NjVcbiAgICAgIGF1dGg6IHtcbiAgICAgICAgdXNlcjogcHJvY2Vzcy5lbnYuU01UUF9VU0VSISxcbiAgICAgICAgcGFzczogcHJvY2Vzcy5lbnYuU01UUF9QQVNTISxcbiAgICAgIH0sXG4gICAgfSk7XG4gIH1cblxuICB0cnkge1xuICAgIGNvbnN0IGluZm8gPSBhd2FpdCB0cmFuc3BvcnRlci5zZW5kTWFpbCh7XG4gICAgICBmcm9tOiAnXCJZb3VyIEFwcFwiIDxuby1yZXBseUB5b3VyYXBwLmNvbT4nLFxuICAgICAgdG8sXG4gICAgICBzdWJqZWN0LFxuICAgICAgdGV4dCxcbiAgICAgIGh0bWwsXG4gICAgfSk7XG4gIFxuICAgIC8vIEluIGRldmVsb3BtZW50LCBsb2cgdGhlIHByZXZpZXcgVVJMXG4gICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAgIGNvbnNvbGUubG9nKCdFbWFpbCBwcmV2aWV3IFVSTDonLCBub2RlbWFpbGVyLmdldFRlc3RNZXNzYWdlVXJsKGluZm8pKTtcbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3Igc2VuZGluZyBlbWFpbDonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJub2RlbWFpbGVyIiwic2VuZEVtYWlsIiwidG8iLCJzdWJqZWN0IiwidGV4dCIsImh0bWwiLCJ0cmFuc3BvcnRlciIsInByb2Nlc3MiLCJ0ZXN0QWNjb3VudCIsImNyZWF0ZVRlc3RBY2NvdW50IiwiY3JlYXRlVHJhbnNwb3J0IiwiaG9zdCIsInNtdHAiLCJwb3J0Iiwic2VjdXJlIiwiYXV0aCIsInVzZXIiLCJwYXNzIiwiZW52IiwiU01UUF9IT1NUIiwiTnVtYmVyIiwiU01UUF9QT1JUIiwiU01UUF9TRUNVUkUiLCJTTVRQX1VTRVIiLCJTTVRQX1BBU1MiLCJpbmZvIiwic2VuZE1haWwiLCJmcm9tIiwiY29uc29sZSIsImxvZyIsImdldFRlc3RNZXNzYWdlVXJsIiwiZXJyb3IiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./utils/emails.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/better-auth","vendor-chunks/@better-fetch","vendor-chunks/kysely","vendor-chunks/mysql2","vendor-chunks/nodemailer","vendor-chunks/aws-ssl-profiles","vendor-chunks/iconv-lite","vendor-chunks/zod","vendor-chunks/better-call","vendor-chunks/@noble","vendor-chunks/jose","vendor-chunks/long","vendor-chunks/lru-cache","vendor-chunks/@better-auth","vendor-chunks/denque","vendor-chunks/is-property","vendor-chunks/lru.min","vendor-chunks/rou3","vendor-chunks/sqlstring","vendor-chunks/seq-queue","vendor-chunks/named-placeholders","vendor-chunks/generate-function","vendor-chunks/safer-buffer","vendor-chunks/defu","vendor-chunks/uncrypto"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fproducts%2Froute&page=%2Fapi%2Fproducts%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fproducts%2Froute.ts&appDir=%2Fhome%2Fzodx%2FDesktop%2Fproyectx%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fzodx%2FDesktop%2Fproyectx&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();